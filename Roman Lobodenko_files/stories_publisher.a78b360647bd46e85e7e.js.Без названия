!function(e){function t(t){for(var n,i,s=t[0],c=t[1],u=t[2],d=0,f=[];d<s.length;d++)i=s[d],o[i]&&f.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);f.length;)f.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==o[c]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={"web/stories_publisher":0},a=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/js/cmodules/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([206,"bundles/common","bundles/vendors","bundles/2e5a4b7ccf73f69b6674227138be6738"]),r()}({"/MKj":function(e,t,r){"use strict";r.r(t);var n=r("JX7q"),o=r("dI71"),a=r("q1tI"),i=r.n(a),s=r("17x9"),c=r.n(s),u=i.a.createContext(null);var l=function(e){e()},d=function(){return l},f=null,p={notify:function(){}};var h=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=p,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){var e,t,r;this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=(e=d(),t=[],r=[],{clear:function(){r=f,t=f},notify:function(){var n=t=r;e(function(){for(var e=0;e<n.length;e++)n[e]()})},get:function(){return r},subscribe:function(e){var n=!0;return r===t&&(r=t.slice()),r.push(e),function(){n&&t!==f&&(n=!1,r===t&&(r=t.slice()),r.splice(r.indexOf(e),1))}}}))},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=p)},e}(),m=function(e){function t(t){var r;r=e.call(this,t)||this;var o=t.store;r.notifySubscribers=r.notifySubscribers.bind(Object(n.default)(r));var a=new h(o);return a.onStateChange=r.notifySubscribers,r.state={store:o,subscription:a},r.previousState=o.getState(),r}Object(o.default)(t,e);var r=t.prototype;return r.componentDidMount=function(){this._isMounted=!0,this.state.subscription.trySubscribe(),this.previousState!==this.props.store.getState()&&this.state.subscription.notifyNestedSubs()},r.componentWillUnmount=function(){this.unsubscribe&&this.unsubscribe(),this.state.subscription.tryUnsubscribe(),this._isMounted=!1},r.componentDidUpdate=function(e){if(this.props.store!==e.store){this.state.subscription.tryUnsubscribe();var t=new h(this.props.store);t.onStateChange=this.notifySubscribers,this.setState({store:this.props.store,subscription:t})}},r.notifySubscribers=function(){this.state.subscription.notifyNestedSubs()},r.render=function(){var e=this.props.context||u;return i.a.createElement(e.Provider,{value:this.state},this.props.children)},t}(a.Component);m.propTypes={store:c.a.shape({subscribe:c.a.func.isRequired,dispatch:c.a.func.isRequired,getState:c.a.func.isRequired}),context:c.a.object,children:c.a.any};var y=m,v=r("wx14"),g=r("zLVn"),_=r("2mql"),E=r.n(_),b=r("QLaP"),w=r.n(b),O=r("TOwV"),S=[],T=[null,null];function P(e,t){var r=e[1];return[t.payload,r+1]}var C=function(){return[null,0]},x="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?a.useLayoutEffect:a.useEffect;function N(e,t){void 0===t&&(t={});var r=t,n=r.getDisplayName,o=void 0===n?function(e){return"ConnectAdvanced("+e+")"}:n,s=r.methodName,c=void 0===s?"connectAdvanced":s,l=r.renderCountProp,d=void 0===l?void 0:l,f=r.shouldHandleStateChanges,p=void 0===f||f,m=r.storeKey,y=void 0===m?"store":m,_=r.withRef,b=void 0!==_&&_,N=r.forwardRef,R=void 0!==N&&N,L=r.context,j=void 0===L?u:L,D=Object(g.default)(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);w()(void 0===d,"renderCountProp is removed. render counting is built into the latest React Dev Tools profiling extension"),w()(!b,"withRef is removed. To access the wrapped instance, use a ref on the connected component");w()("store"===y,"storeKey has been removed and does not do anything. To use a custom Redux store for specific components, create a custom React context with React.createContext(), and pass the context object to React Redux's Provider and specific components like: <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect");var k=j;return function(t){var r=t.displayName||t.name||"Component",n=o(r),s=Object(v.default)({},D,{getDisplayName:o,methodName:c,renderCountProp:d,shouldHandleStateChanges:p,storeKey:y,displayName:n,wrappedComponentName:r,WrappedComponent:t}),u=D.pure;var l=u?a.useMemo:function(e){return e()};function f(r){var o=Object(a.useMemo)(function(){var e=r.forwardedRef,t=Object(g.default)(r,["forwardedRef"]);return[r.context,e,t]},[r]),c=o[0],u=o[1],d=o[2],f=Object(a.useMemo)(function(){return c&&c.Consumer&&Object(O.isContextConsumer)(i.a.createElement(c.Consumer,null))?c:k},[c,k]),m=Object(a.useContext)(f),y=Boolean(r.store),_=Boolean(m)&&Boolean(m.store);w()(y||_,'Could not find "store" in the context of "'+n+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+n+" in connect options.");var E=r.store||m.store,b=Object(a.useMemo)(function(){return function(t){return e(t.dispatch,s)}(E)},[E]),N=Object(a.useMemo)(function(){if(!p)return T;var e=new h(E,y?null:m.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]},[E,y,m]),R=N[0],L=N[1],j=Object(a.useMemo)(function(){return y?m:Object(v.default)({},m,{subscription:R})},[y,m,R]),D=Object(a.useReducer)(P,S,C),I=D[0][0],A=D[1];if(I&&I.error)throw I.error;var M=Object(a.useRef)(),B=Object(a.useRef)(d),F=Object(a.useRef)(),U=Object(a.useRef)(!1),H=l(function(){return F.current&&d===B.current?F.current:b(E.getState(),d)},[E,I,d]);x(function(){B.current=d,M.current=H,U.current=!1,F.current&&(F.current=null,L())}),x(function(){if(p){var e=!1,t=null,r=function(){if(!e){var r,n,o=E.getState();try{r=b(o,B.current)}catch(e){n=e,t=e}n||(t=null),r===M.current?U.current||L():(M.current=r,F.current=r,U.current=!0,A({type:"STORE_UPDATED",payload:{latestStoreState:o,error:n}}))}};R.onStateChange=r,R.trySubscribe(),r();return function(){if(e=!0,R.tryUnsubscribe(),t)throw t}}},[E,R,b]);var Y=Object(a.useMemo)(function(){return i.a.createElement(t,Object(v.default)({},H,{ref:u}))},[u,t,H]);return Object(a.useMemo)(function(){return p?i.a.createElement(f.Provider,{value:j},Y):Y},[f,Y,j])}var m=u?i.a.memo(f):f;if(m.WrappedComponent=t,m.displayName=n,R){var _=i.a.forwardRef(function(e,t){return i.a.createElement(m,Object(v.default)({},e,{forwardedRef:t}))});return _.displayName=n,_.WrappedComponent=t,E()(_,t)}return E()(m,t)}}var R=Object.prototype.hasOwnProperty;function L(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function j(e,t){if(L(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!R.call(t,r[o])||!L(e[r[o]],t[r[o]]))return!1;return!0}var D=r("ANjH");function k(e){return function(t,r){var n=e(t,r);function o(){return n}return o.dependsOnOwnProps=!1,o}}function I(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function A(e,t){return function(t,r){r.displayName;var n=function(e,t){return n.dependsOnOwnProps?n.mapToProps(e,t):n.mapToProps(e)};return n.dependsOnOwnProps=!0,n.mapToProps=function(t,r){n.mapToProps=e,n.dependsOnOwnProps=I(e);var o=n(t,r);return"function"==typeof o&&(n.mapToProps=o,n.dependsOnOwnProps=I(o),o=n(t,r)),o},n}}var M=[function(e){return"function"==typeof e?A(e):void 0},function(e){return e?void 0:k(function(e){return{dispatch:e}})},function(e){return e&&"object"==typeof e?k(function(t){return Object(D.bindActionCreators)(e,t)}):void 0}];var B=[function(e){return"function"==typeof e?A(e):void 0},function(e){return e?void 0:k(function(){return{}})}];function F(e,t,r){return Object(v.default)({},r,e,t)}var U=[function(e){return"function"==typeof e?function(e){return function(t,r){r.displayName;var n,o=r.pure,a=r.areMergedPropsEqual,i=!1;return function(t,r,s){var c=e(t,r,s);return i?o&&a(c,n)||(n=c):(i=!0,n=c),n}}}(e):void 0},function(e){return e?void 0:function(){return F}}];function H(e,t,r,n){return function(o,a){return r(e(o,a),t(n,a),a)}}function Y(e,t,r,n,o){var a,i,s,c,u,l=o.areStatesEqual,d=o.areOwnPropsEqual,f=o.areStatePropsEqual,p=!1;function h(o,p){var h,m,y=!d(p,i),v=!l(o,a);return a=o,i=p,y&&v?(s=e(a,i),t.dependsOnOwnProps&&(c=t(n,i)),u=r(s,c,i)):y?(e.dependsOnOwnProps&&(s=e(a,i)),t.dependsOnOwnProps&&(c=t(n,i)),u=r(s,c,i)):v?(h=e(a,i),m=!f(h,s),s=h,m&&(u=r(s,c,i)),u):u}return function(o,l){return p?h(o,l):(s=e(a=o,i=l),c=t(n,i),u=r(s,c,i),p=!0,u)}}function W(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,a=Object(g.default)(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),i=r(e,a),s=n(e,a),c=o(e,a);return(a.pure?Y:H)(i,s,c,e,a)}function K(e,t,r){for(var n=t.length-1;n>=0;n--){var o=t[n](e);if(o)return o}return function(t,n){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+n.wrappedComponentName+".")}}function G(e,t){return e===t}var X,V,q,z,$,Z,J,Q,ee,te,re,ne,oe=(q=(V=void 0===X?{}:X).connectHOC,z=void 0===q?N:q,$=V.mapStateToPropsFactories,Z=void 0===$?B:$,J=V.mapDispatchToPropsFactories,Q=void 0===J?M:J,ee=V.mergePropsFactories,te=void 0===ee?U:ee,re=V.selectorFactory,ne=void 0===re?W:re,function(e,t,r,n){void 0===n&&(n={});var o=n,a=o.pure,i=void 0===a||a,s=o.areStatesEqual,c=void 0===s?G:s,u=o.areOwnPropsEqual,l=void 0===u?j:u,d=o.areStatePropsEqual,f=void 0===d?j:d,p=o.areMergedPropsEqual,h=void 0===p?j:p,m=Object(g.default)(o,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),y=K(e,Z,"mapStateToProps"),_=K(t,Q,"mapDispatchToProps"),E=K(r,te,"mergeProps");return z(ne,Object(v.default)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:y,initMapDispatchToProps:_,initMergeProps:E,pure:i,areStatesEqual:c,areOwnPropsEqual:l,areStatePropsEqual:f,areMergedPropsEqual:h},m))});function ae(){var e=Object(a.useContext)(u);return w()(e,"could not find react-redux context value; please ensure the component is wrapped in a <Provider>"),e}function ie(){return ae().store}function se(){return ie().dispatch}var ce="undefined"!=typeof window?a.useLayoutEffect:a.useEffect,ue=function(e,t){return e===t};function le(e,t){void 0===t&&(t=ue),w()(e,"You must pass a selector to useSelectors");var r,n=ae(),o=n.store,i=n.subscription,s=Object(a.useReducer)(function(e){return e+1},0)[1],c=Object(a.useMemo)(function(){return new h(o,i)},[o,i]),u=Object(a.useRef)(),l=Object(a.useRef)(),d=Object(a.useRef)();try{r=e!==l.current||u.current?e(o.getState()):d.current}catch(e){var f="An error occured while selecting the store state: "+e.message+".";throw u.current&&(f+="\nThe error may be correlated with this previous error:\n"+u.current.stack+"\n\nOriginal stack trace:"),new Error(f)}return ce(function(){l.current=e,d.current=r,u.current=void 0}),ce(function(){function e(){try{var e=l.current(o.getState());if(t(e,d.current))return;d.current=e}catch(e){u.current=e}s({})}return c.onStateChange=e,c.trySubscribe(),e(),function(){return c.tryUnsubscribe()}},[o,c]),r}var de,fe=r("i8i4");r.d(t,"Provider",function(){return y}),r.d(t,"connectAdvanced",function(){return N}),r.d(t,"ReactReduxContext",function(){return u}),r.d(t,"connect",function(){return oe}),r.d(t,"batch",function(){return fe.unstable_batchedUpdates}),r.d(t,"useDispatch",function(){return se}),r.d(t,"useSelector",function(){return le}),r.d(t,"useStore",function(){return ie}),r.d(t,"shallowEqual",function(){return j}),de=fe.unstable_batchedUpdates,l=de},"/TnQ":function(e,t,r){"use strict";var n=r("ANjH").compose;t.__esModule=!0,t.composeWithDevTools=function(){if(0!==arguments.length)return"object"==typeof arguments[0]?n:n.apply(null,arguments)},t.devToolsEnhancer=function(){return function(e){return e}}},"16Al":function(e,t,r){"use strict";var n=r("WbBG");function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,a,i){if(i!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return r.PropTypes=r,r}},"17x9":function(e,t,r){e.exports=r("16Al")()},"1y80":function(e,t,r){"use strict";function n(e,t,r,n,o){return window.statlogsValueEvent(e,t,r,n,o)}function o(e){return Math.random()<e}function a(e,t,r,a,i,s){o(e)&&n(t,r,a,i,s)}r.r(t),r.d(t,"statlogsValueEvent",function(){return n}),r.d(t,"randEnabled",function(){return o}),r.d(t,"statlogsProbValueEvent",function(){return a})},206:function(e,t,r){e.exports=r("e9h0")},"2mql":function(e,t,r){"use strict";var n=r("TOwV"),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return n.isMemo(e)?i:s[e.$$typeof]||o}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var u=Object.defineProperty,l=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(h){var o=p(r);o&&o!==h&&e(t,o,n)}var i=l(r);d&&(i=i.concat(d(r)));for(var s=c(t),m=c(r),y=0;y<i.length;++y){var v=i[y];if(!(a[v]||n&&n[v]||m&&m[v]||s&&s[v])){var g=f(r,v);try{u(t,v,g)}catch(e){}}}return t}return t}},"3UD+":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"6raB":function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return u});r("91GP"),r("ioFf"),r("rGqo"),r("Btvt");var n=r("q1tI"),o=(r("17x9"),r("pemR")),a=r("KFTi"),i=r("Hx9h");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}class u extends n.Component{constructor(e){super(e),this.needRecalcSize=!1,this.state={}}render(){var e=this.props,t=e.className,r=e.loading,u=e.children,l=c(e,["className","loading","children"]),d=Object(o.classNames)("ButtonWithProgress",{"ButtonWithProgress--loading":r},t);return n.createElement(i.default,s({},l,{className:d}),n.createElement("span",{className:"ButtonWithProgress__content"},u),r&&n.createElement(a.default,{inverted:"primary"===e.appearance,className:"ButtonWithProgress__progress"}))}}u.defaultProps={appearance:"primary",size:"m",wide:!1,loading:!1}},ANjH:function(e,t,r){"use strict";r.r(t),r.d(t,"createStore",function(){return s}),r.d(t,"combineReducers",function(){return u}),r.d(t,"bindActionCreators",function(){return d}),r.d(t,"applyMiddleware",function(){return m}),r.d(t,"compose",function(){return h}),r.d(t,"__DO_NOT_USE__ActionTypes",function(){return a});var n=r("bCCX"),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},a={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function i(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function s(e,t,r){var o;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(s)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var c=e,u=t,l=[],d=l,f=!1;function p(){d===l&&(d=l.slice())}function h(){if(f)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function m(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(f)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return p(),d.push(e),function(){if(t){if(f)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,p();var r=d.indexOf(e);d.splice(r,1)}}}function y(e){if(!i(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(f)throw new Error("Reducers may not dispatch actions.");try{f=!0,u=c(u,e)}finally{f=!1}for(var t=l=d,r=0;r<t.length;r++){(0,t[r])()}return e}return y({type:a.INIT}),(o={dispatch:y,subscribe:m,getState:h,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");c=e,y({type:a.REPLACE})}})[n.default]=function(){var e,t=m;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(h())}return r(),{unsubscribe:t(r)}}})[n.default]=function(){return this},e},o}function c(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];0,"function"==typeof e[o]&&(r[o]=e[o])}var i,s=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:a.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:a.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+a.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(r)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var n=!1,o={},a=0;a<s.length;a++){var u=s[a],l=r[u],d=e[u],f=l(d,t);if(void 0===f){var p=c(u,t);throw new Error(p)}o[u]=f,n=n||f!==d}return n?o:e}}function l(e,t){return function(){return t(e.apply(this,arguments))}}function d(e,t){if("function"==typeof e)return l(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=Object.keys(e),n={},o=0;o<r.length;o++){var a=r[o],i=e[a];"function"==typeof i&&(n[a]=l(i,t))}return n}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){f(e,t,r[t])})}return e}function h(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function m(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},a=t.map(function(e){return e(o)});return p({},r,{dispatch:n=h.apply(void 0,a)(r.dispatch)})}}}},Cb16:function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});r("91GP");var n=r("q1tI");r("17x9");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}class a extends n.Component{constructor(e){if(super(e),this.props.defaultValue<0||this.props.defaultValue>1)throw new Error("Bad defaultValue specified to Slider");this.containerRef=n.createRef()}componentDidUpdate(e){this.props.value!==e.value&&this.sliderElement.setValue(this.props.value,!0)}componentDidMount(){this.sliderElement=new window.Slider(this.containerRef.current,o({size:1,value:this.props.defaultValue,formatHint:this.props.formatHint,onChange:this.props.onChange},this.props))}render(){return n.createElement("div",{className:`Slider Slider--${this.props.color} ${this.props.className}`,ref:this.containerRef})}}a.defaultProps={color:"blue",defaultValue:.5,formatHint:e=>Math.round(100*e)}},D2Nl:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r("JHWP")),a=r("Iwry"),i=/url\((['"]?)([^'"]+?)\1\)/g;function s(e){var t=[];return e.replace(i,function(e,r,n){return t.push(n),e}),t.filter(function(e){return!a.isDataUrl(e)})}function c(e,t,r,n){var i=r?function(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;var r=document.implementation.createHTMLDocument(),n=r.createElement("base"),o=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(o),t&&(n.href=t),o.href=e,o.href}(t,r):t;return Promise.resolve(i).then(function(e){return o.default(e,n)}).then(function(e){return a.toDataURL(e,a.getMimeType(t))}).then(function(r){return e.replace(new RegExp("(url\\(['\"]?)("+function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}(t)+")(['\"]?\\))","g"),"$1"+r+"$3")}).then(function(e){return e},function(){return i})}function u(e){return-1!==e.search(i)}t.shouldEmbed=u,t.default=function(e,t,r){return u(e)?Promise.resolve(e).then(s).then(function(n){return n.reduce(function(e,n){return e.then(function(e){return c(e,n,t,r)})},Promise.resolve(e))}):Promise.resolve(e)}},Hx9h:function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});r("91GP"),r("ioFf"),r("rGqo"),r("Btvt");var n=r("q1tI"),o=(r("17x9"),r("pemR"));function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}class s extends n.Component{render(){var e=this.props,t=e.className,r=e.appearance,s=e.wide,c=e.overflow,u=e.size,l=i(e,["className","appearance","wide","overflow","size"]),d=Object(o.classNames)("Button",...Array.isArray(r)?r.map(e=>`Button--${e}`):[`Button--${r}`],`Button--size-${u}`,{"Button--wide":!!s,"Button--overflow":!!c,"Button--disabled":!!e.disabled},t);return n.createElement("button",a({},l,{className:d}),e.children)}}s.defaultProps={appearance:"primary",size:"m",wide:!1,disabled:!1}},Iwry:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o="application/font-woff",a={woff:o,woff2:o,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"};function i(e){var t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function s(e){var t=i(e).toLowerCase();return a[t]||""}function c(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.crossOrigin="anonymous",n.src=e})}function u(e){return e.split(/,/)[1]}function l(e,t){var r=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(r.replace("px",""))}function d(){return window.devicePixelRatio||1}t.uuid=(n=0,function(){return n+=1,"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+n}),t.parseExtension=i,t.getMimeType=s,t.delay=function(e){return function(t){return new Promise(function(r){setTimeout(function(){r(t)},e)})}},t.createImage=c,t.isDataUrl=function(e){return-1!==e.search(/^(data:)/)},t.toDataURL=function(e,t){return"data:"+t+";base64,"+e},t.getDataURLContent=u,t.canvasToBlob=function(e){return e.toBlob?new Promise(function(t){e.toBlob(t)}):function(e){return new Promise(function(t){for(var r=window.atob(e.toDataURL().split(",")[1]),n=r.length,o=new Uint8Array(n),a=0;a<n;a+=1)o[a]=r.charCodeAt(a);t(new Blob([o],{type:"image/png"}))})}(e)},t.toArray=function(e){for(var t=[],r=0,n=e.length;r<n;r+=1)t.push(e[r]);return t},t.getNodeWidth=function(e){var t=l(e,"border-left-width"),r=l(e,"border-right-width");return e.scrollWidth+t+r},t.getNodeHeight=function(e){var t=l(e,"border-top-width"),r=l(e,"border-bottom-width");return e.scrollHeight+t+r},t.getPixelRatio=d,t.svgToDataURL=function(e){return Promise.resolve().then(function(){return(new XMLSerializer).serializeToString(e)}).then(encodeURIComponent).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})},t.getBlobFromImageURL=function(e){return c(e).then(function(t){var r=t.width,n=t.height,o=document.createElement("canvas"),a=o.getContext("2d"),i=d();return o.width=r*i,o.height=n*i,o.style.width=""+r,o.style.height=""+n,a.scale(i,i),a.drawImage(t,0,0),u(o.toDataURL(s(e)))})}},JHWP:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("Iwry"),o=3e4;t.default=function(e,t){return t.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime()),(window.fetch?window.fetch(e).then(function(e){return e.blob()}).then(function(e){return new Promise(function(t,r){var n=new FileReader;n.onloadend=function(){return t(n.result)},n.onerror=r,n.readAsDataURL(e)})}).then(n.getDataURLContent).catch(function(){return new Promise(function(e,t){t()})}):new Promise(function(t,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var o=new FileReader;o.onloadend=function(){t(n.getDataURLContent(o.result))},o.readAsDataURL(a.response)}else r(new Error("Failed to fetch resource: "+e+", status: "+a.status))},a.ontimeout=function(){r(new Error("Timeout of "+o+"ms occured while fetching resource: "+e))},a.responseType="blob",a.timeout=o,a.open("GET",e,!0),a.send()})).catch(function(r){var n="";if(t.imagePlaceholder){var o=t.imagePlaceholder.split(/,/);o&&o[1]&&(n=o[1])}var a="Failed to fetch resource: "+e;return r&&(a="string"==typeof r?r:r.message),a&&console.error(a),n})}},JX7q:function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.r(t),r.d(t,"default",function(){return n})},KFTi:function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return a});var n=r("q1tI"),o=(r("17x9"),r("pemR"));function a(e){var t=Object(o.classNames)("Progress",{"Progress--inverted":e.inverted},e.className);return n.createElement("div",{className:t},n.createElement("div",{className:"Progress__item"}),n.createElement("div",{className:"Progress__item"}),n.createElement("div",{className:"Progress__item"}))}a.defaultProps={inverted:!1}},PjZB:function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return o});r("rGqo"),r("a1Th"),r("Btvt");var n=r("q1tI");r("17x9");class o extends n.Component{constructor(e){super(e),this.id=Math.round(1e6*Math.random()).toString(16),this.setSpinnerParams(e)}componentWillReceiveProps(e){this.setSpinnerParams(e)}setSpinnerParams(e){this.offset=Math.round(Math.PI*e.size),this.c=.5*e.size,this.animation=function(e,t){if(!e||!t)return"";var r=Object.keys(t).map(e=>e+" {"+Object.keys(t[e]).map(r=>r+":"+t[e][r]).join(";")+"}").join("");return`@-webkit-keyframes ${e} {${r}} @keyframes ${e} {${r}}`}("dash"+this.id,{"0%":{"stroke-dashoffset":this.offset},"50%":{"stroke-dashoffset":Math.round(.25*this.offset),transform:"rotate(135deg)"},"100%":{"stroke-dashoffset":this.offset,transform:"rotate(360deg)"}})}render(){var e=this.props,t=e.style,r=e.color,o=e.size,a=e.duration,i=e.strokeWidth,s=this.id,c=this.offset,u=this.animation;return n.createElement("div",{className:"Spinner",style:t},n.createElement("svg",{className:"Spinner__svg",width:o,height:o,viewBox:`0 0 ${o} ${o}`,xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{style:{width:o,height:o,transformOrigin:.5*o+"px "+.5*o+"px"}},n.createElement("style",{dangerouslySetInnerHTML:{__html:u}}),n.createElement("circle",{className:"Spinner__path",fill:"none",stroke:r,strokeDasharray:c,strokeDashoffset:c,strokeWidth:i,style:{animationName:"dash"+s,animationTimingFunction:"ease-in-out",animationDuration:a+"s",animationIterationCount:"infinite"},cx:.5*o,cy:.5*o,r:.5*o-.5*i}))))}}o.defaultProps={color:"#5181b8",size:19,strokeWidth:2,duration:1.4}},QLaP:function(e,t,r){"use strict";e.exports=function(e,t,r,n,o,a,i,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,o,a,i,s],l=0;(c=new Error(t.replace(/%s/g,function(){return u[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},Qc8c:function(e,t,r){"use strict";function n(e){return new Promise(function(t,r){var n=new Image;n.crossOrigin="Anonymous",n.onerror=function(){r(new Error("Failed to load image's URL: "+e))},n.onload=function(){t(n)},n.src=e})}function o(e,t){if(!t)return{x:0,y:0,xOrigin:0,yOrigin:0};var r=t.getBoundingClientRect(),n=r.left,o=r.top;return{x:e.clientX-n,y:e.clientY-o,xOrigin:n,yOrigin:o}}function a(e,t){var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?"rgba("+parseInt(r[1],16)+", "+parseInt(r[2],16)+", "+parseInt(r[3],16)+", "+t+")":"rgba(0, 0, 0, 1)"}function i(e){var t,r={r:0,g:0,b:0};if(!e)return r;try{t=e.getImageData(0,0,e.canvas.width,e.canvas.height)}catch(e){return r}for(var n=-4,o=0;(n+=20)<t.data.length;)++o,r.r+=t.data[n],r.g+=t.data[n+1],r.b+=t.data[n+2];return r.r=~~(r.r/o),r.g=~~(r.g/o),r.b=~~(r.b/o),r}function s(){return new Promise(function(e,t){var r=document.createElement("input");r.value="",r.type="file",r.accept="image/*",r.onchange=function(o){var a=o.target;if(r.remove(),!a)return t();if(!a.files)return t();var i=a.files[0],s=URL.createObjectURL(i);n(s).then(function(){c(i).then(function(r){-1===r||-2===r||1===r?e(s):function(e,t){return new Promise(function(r,n){var o=new Image;o.onload=function(){var e=o.width,a=o.height,i=document.createElement("canvas"),s=i.getContext("2d");if(!s)return n();switch(4<t&&t<9?(i.width=a,i.height=e):(i.width=e,i.height=a),t){case 2:s.transform(-1,0,0,1,e,0);break;case 3:s.transform(-1,0,0,-1,e,a);break;case 4:s.transform(1,0,0,-1,0,a);break;case 5:s.transform(0,1,1,0,0,0);break;case 6:s.transform(0,1,-1,0,a,0);break;case 7:s.transform(0,-1,-1,0,a,e);break;case 8:s.transform(0,-1,1,0,0,e)}s.drawImage(o,0,0),r(i.toDataURL())},o.src=e})}(s,r).then(function(t){e(t)}).catch(function(){t()})}).catch(function(){t()})}).catch(function(){t()})},document.body.appendChild(r),r.click()})}function c(e){return new Promise(function(t){var r=new FileReader;r.onload=function(e){if(e.target){var r=e.target,n=new DataView(r.result);if(65496!=n.getUint16(0,!1))return t(-2);for(var o=n.byteLength,a=2;a<o;){if(n.getUint16(a+2,!1)<=8)return t(-1);var i=n.getUint16(a,!1);if(a+=2,65505==i){if(1165519206!=n.getUint32(a+=2,!1))return t(-1);var s=18761==n.getUint16(a+=6,!1);a+=n.getUint32(a+4,s);var c=n.getUint16(a,s);a+=2;for(var u=0;u<c;u++)if(274==n.getUint16(a+12*u,s))return t(n.getUint16(a+12*u+8,s))}else{if(65280!=(65280&i))break;a+=n.getUint16(a,!1)}}return t(-1)}},r.readAsArrayBuffer(e)})}r.r(t),r.d(t,"loadImage",function(){return n}),r.d(t,"getRelativeXY",function(){return o}),r.d(t,"hexToRgba",function(){return a}),r.d(t,"getAverageRGB",function(){return i}),r.d(t,"uploadLocalImage",function(){return s}),r.d(t,"getOrientation",function(){return c})},SLVX:function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.r(t),r.d(t,"default",function(){return n})},"T/g7":function(e,t,r){"use strict";r.r(t),r.d(t,"getLang",function(){return s});var n=r("nAFc"),o={},a=window.getLang,i=window.langNumeric;function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,s="number"==typeof t,c=e+(t||s?".raw":"");if(void 0===o[c]){var u=t||s?a(e,"raw"):a(e);"string"==typeof u?o[c]=Object(n.decodeHTMLEntities)(u):Array.isArray(u)&&(o[c]=u.map(n.decodeHTMLEntities))}return s?i(t,o[c],r):o[c]||""}t.default={getLang:s}},TBLV:function(e,t,r){"use strict";r.r(t);r("91GP"),r("ioFf"),r("rGqo"),r("Btvt");var n=r("q1tI"),o=(r("17x9"),r("pemR"));function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=e=>{var t=e.className,r=e.children,s=i(e,["className","children"]),c=Object(o.classNames)("Radio",t,{"Radio--disabled":e.disabled});return n.createElement("label",{className:c},n.createElement("input",a({className:"Radio__input Radio__visuallyHidden",type:"radio"},s)),n.createElement("span",{className:"Radio__control"}),Boolean(r)&&n.createElement("span",{className:"Radio__text"},r))};s.defaultProps={className:"",name:void 0,onChange:void 0,checked:void 0,defaultChecked:void 0,autoFocus:!1,disabled:!1,children:null},t.default=s},TOwV:function(e,t,r){"use strict";e.exports=r("qT12")},UlUB:function(e,t,r){"use strict";function n(e,t){var r,n,o=!1;return function a(){if(o)return r=arguments,void(n=this);e.apply(this,arguments),o=!0,setTimeout(function(){o=!1,r&&(a.apply(n,r),r=n=null)},t)}}r.r(t),r.d(t,"default",function(){return n})},WbBG:function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},WfVW:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r("Iwry"),a=n(r("JHWP")),i=n(r("D2Nl"));function s(e,t){return e instanceof Element?Promise.resolve(e).then(function(e){return function(e,t){var r=e.style.getPropertyValue("background");return r?Promise.resolve(r).then(function(e){return i.default(e,null,t)}).then(function(t){return e.style.setProperty("background",t,e.style.getPropertyPriority("background")),e}):Promise.resolve(e)}(e,t)}).then(function(e){return function(e,t){return e instanceof HTMLImageElement&&!o.isDataUrl(e.src)?Promise.resolve(e.src).then(function(e){return a.default(e,t)}).then(function(t){return o.toDataURL(t,o.getMimeType(e.src))}).then(function(t){return new Promise(function(r,n){e.onload=r,e.onerror=n,e.src=t})}).then(function(){return e},function(){return e}):Promise.resolve(e)}(e,t)}).then(function(e){return function(e,t){var r=o.toArray(e.childNodes).map(function(e){return s(e,t)});return Promise.all(r).then(function(){return e})}(e,t)}):Promise.resolve(e)}t.default=s},XpgC:function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return l});r("91GP");var n=r("q1tI"),o=r("i8i4"),a=(r("17x9"),r("pemR")),i=r("clTp");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var c=()=>"undefined"!=typeof window,u=e=>{var t=e.position,r=e.align,n=e.text,o=e.rect,a=e.marginTop,i=e.marginLeft,s=e.maxWidth,c=e.appearance,u=o.left,l=o.top;switch(t){case"t":u+=.5*o.width;break;case"r":u+=o.width,l+=.5*o.height;break;case"b":u+=.5*o.width,l+=o.height;break;case"l":l+=.5*o.height}return{tooltip:{position:t,align:r,text:n,x:u=Math.round(u+i),y:l=Math.round(l+a),maxWidth:s,appearance:c}}};class l extends n.Component{constructor(e){super(e),this.onMouseEnter=e=>{if(this.state.el){var t=this.props,r=t.text,n=t.position,o=t.align,a=t.marginTop,s=t.marginLeft,c=t.maxWidth,u=t.appearance,l=Object(i.default)(this.state.el);this.update({text:r,position:n,align:o,rect:l,marginTop:a,marginLeft:s,maxWidth:c,appearance:u})}},this.onMouseLeave=e=>this.update(),this.onTransitionEnd=e=>{"visibility"===e.propertyName&&this.state.tooltip&&this.setState({tooltip:void 0})},this.renderTooltip=()=>{if(!this.state.tooltip)return null;var e=this.state.tooltip,t=e.x,r=e.y,o=e.position,i=e.align,s=e.text,c=e.removed,u=e.maxWidth,l=e.appearance,d=Object(a.classNames)("Tooltip",`Tooltip--${o}`,`Tooltip--${l}`,{"Tooltip--removed":!!c,[`Tooltip--align-${i}`]:"t"===o||"b"===o});return n.createElement("div",{className:d,style:{top:r,left:t},onTransitionEnd:this.onTransitionEnd},n.createElement("div",{className:"Tooltip__in",style:{maxWidth:u},dangerouslySetInnerHTML:{__html:s}}))},this.state={}}componentDidMount(){var e=o.findDOMNode(this);this.setState({el:e}),e.addEventListener("mouseenter",this.onMouseEnter),e.addEventListener("mouseleave",this.onMouseLeave)}componentWillUnmount(){this.state.el.removeEventListener("mouseenter",this.onMouseEnter),this.state.el.removeEventListener("mouseleave",this.onMouseLeave)}static getDerivedStateFromProps(e,t){return t.tooltip&&["text","position","align","maxWidth","appearance"].some(r=>e[r]!==t.tooltip[r])?u(s({},e,{rect:Object(i.default)(t.el)})):null}update(e){if(!e)return this.setState({tooltip:Object.assign({},this.state.tooltip,{removed:!0})});this.setState(u(e))}render(){var e=this.renderTooltip();return e?(!this.defaultNode&&c()&&(this.defaultNode=document.createElement("div"),document.body.appendChild(this.defaultNode)),n.createElement(n.Fragment,null,this.props.children,o.createPortal(e,this.defaultNode))):this.props.children}}l.defaultProps={position:"b",align:"center",marginTop:0,marginLeft:0,appearance:"dark"}},Ya8i:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=r("Iwry"),a=n(r("D2Nl"));function i(e){if(void 0===e)return[];var t=e,r=[],n=new RegExp("(\\/\\*[\\s\\S]*?\\*\\/)","gi");t=t.replace(n,"");for(var o,a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");null!==(o=a.exec(t));)r.push(o[0]);t=t.replace(a,"");for(var i=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");null!==(o=i.exec(t));)r.push(o[0]);return r}function s(e,t){return fetch(e).then(function(t){return{url:e,cssText:t.text()}},function(e){console.log("ERROR FETCHING CSS: ",e.toString())})}function c(e){return e.cssText.then(function(t){var r=t,n=(r.match(/url\([^)]+\)/g)||[]).map(function(t){var n=t.replace(/url\(([^]+)\)/g,"$1");if(!n.startsWith("https://")){var o=e.url;n=new URL(n,o).href}return new Promise(function(e,o){fetch(n).then(function(e){return e.blob()}).then(function(n){var o=new FileReader;o.addEventListener("load",function(n){r=r.replace(t,"url("+o.result+")"),e([t,o.result])}),o.readAsDataURL(n)}).catch(o)})});return Promise.all(n).then(function(){return r})})}function u(e){var t=[],r=[];return e.forEach(function(t){if("cssRules"in t)try{o.toArray(t.cssRules).forEach(function(e){e.type===CSSRule.IMPORT_RULE&&r.push(s(e.href).then(c).then(function(e){i(e).forEach(function(e){t.insertRule(e,t.cssRules.length)})}).catch(function(e){console.log("Error loading remote css",e.toString())}))})}catch(o){var n=e.find(function(e){return null===e.href})||document.styleSheets[0];null!=t.href&&r.push(s(t.href).then(c).then(function(e){i(e).forEach(function(e){n.insertRule(e,t.cssRules.length)})}).catch(function(e){console.log("Error loading remote stylesheet",e.toString())})),console.log("Error inlining remote css file",o.toString())}}),Promise.all(r).then(function(){return e.forEach(function(e){if("cssRules"in e)try{o.toArray(e.cssRules).forEach(function(e){t.push(e)})}catch(t){console.log("Error while reading CSS rules from "+e.href,t.toString())}}),t})}function l(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return a.shouldEmbed(e.style.getPropertyValue("src"))})}function d(e){return new Promise(function(t,r){e.ownerDocument||r(new Error("Provided element is not within a Document")),t(o.toArray(e.ownerDocument.styleSheets))}).then(u).then(l)}t.parseWebFontRules=d,t.default=function(e,t){return d(e).then(function(e){return Promise.all(e.map(function(e){var r=e.parentStyleSheet?e.parentStyleSheet.href:null;return a.default(e.cssText,r,t)}))}).then(function(e){return e.join("\n")}).then(function(t){var r=document.createElement("style"),n=document.createTextNode(t);return r.appendChild(n),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),e})}},bCCX:function(e,t,r){"use strict";r.r(t),function(e,n){var o,a=r("SLVX");o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var i=Object(a.default)(o);t.default=i}.call(this,r("yLpj"),r("3UD+")(e))},clTp:function(e,t,r){"use strict";function n(e){var t=e.getBoundingClientRect(),r=document.body,n=document.documentElement,o=window.pageYOffset||n.scrollTop||r.scrollTop,a=window.pageXOffset||n.scrollLeft||r.scrollLeft,i=n.clientTop||r.clientTop||0,s=n.clientLeft||r.clientLeft||0;return{top:Math.round(t.top+o-i),left:Math.round(t.left+a-s),width:e.offsetWidth,height:e.offsetHeight}}r.r(t),r.d(t,"default",function(){return n})},dI71:function(e,t,r){"use strict";function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}r.r(t),r.d(t,"default",function(){return n})},e9h0:function(e,t,r){"use strict";r.r(t);var n,o=r("q1tI"),a=r("i8i4"),i=r("fjjh"),s=r("jE6c"),c=r("EasH"),u=r("T/g7"),l=r("3oLO"),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=r("r7nW").default,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){var e=window.innerHeight-100,r=e/1.78;return o.createElement(f,{disableBodyScroll:!0,onClose:t.onClose},o.createElement(i.default,{context:"story",photoUrl:t.props.photoUrl,artboardWidth:r,artboardHeight:e,save:t.save,close:t.onClose,addons:{postRawId:t.props.postRawId}}))},t.save=function(e,r,n){var o;void 0===n&&(n={}),n.postRawId&&(o=(n.postRawId.match(/wall(-?\d+_\d+)/)||[])[1]),l.ajax.post("al_stories.php",{act:"get_upload_url",post_raw_id:o,analytics:n.analytics,hash:n.hash,ref:window.cur.module},{onDone:function(n){t.sendToServer(e,n,r)},onFail:function(e){var t=e||Object(u.getLang)("global_error");return window.showFastBox({title:Object(u.getLang)("global_error")},t,Object(u.getLang)("global_close"),function(){r(),window.curBox().hide()}),!0}})},t.sendToServer=function(e,r,n){var o=new FormData,a=encodeURIComponent("edited_"+Object(s.irand)(0,99999)+".jpg");o.append("file0",e,a),fetch(r,{method:"POST",body:o}).then(function(){t.onClose(!0),n()}).catch(function(e){console.error(e)})},t.onClose=function(e,r){r?t.props.onClose():e?(window.Stories&&window.Stories.updateFeedStories&&window.Stories.updateFeedStories(),t.props.onClose()):t.box?(t.box.hide(),delete t.box):t.box=Object(c.showFastBox)({title:Object(u.getLang)("photos_pe_are_you_sure_close_title"),bodyStyle:"padding: 20px; line-height: 160%;",dark:1,forceNoBtn:1,onShow:function(){window.cur._noEscHide=!0},onClean:function(){window.cur._noEscHide=!1}},Object(u.getLang)("photos_pe_are_you_sure_close_text"),Object(u.getLang)("box_yes"),function(){t.props.onClose(),t.box.hide()},Object(u.getLang)("box_no"))},t}return d(t,e),t}(o.Component),h=r("ufMw"),m=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=r("r7nW").default,v=r("Hx9h").default,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){return o.createElement(y,{disableBodyScroll:!0,onClose:t.onClose},o.createElement("div",{className:"FilePicker"},o.createElement("div",{className:"FilePicker__inner"},o.createElement("span",{className:"FilePicker__icon"}),o.createElement("p",{className:"FilePicker__title"},Object(u.getLang)("stories_create_title")),o.createElement("span",{className:"FilePicker__description",dangerouslySetInnerHTML:{__html:Object(u.getLang)("stories_create_description")}}),o.createElement(v,{onClick:t.onSelect},Object(u.getLang)("stories_create_add_photo"))),o.createElement("a",{className:"FilePicker__withoutPhoto",onClick:t.onSkip},Object(u.getLang)("stories_create_without_photo"))))},t.onSelect=function(){Object(h.sendStat)(h.EVENTS.ADD_PHOTO_IN_POPUP),t.props.onSelect()},t.onSkip=function(){Object(h.sendStat)(h.EVENTS.CREATE_STORY_WITHOUT_PHOTO),t.props.onSkip()},t.onClose=function(){t.props.onClose()},t}return m(t,e),t}(o.Component),_=r("4+be"),E=r("Qc8c"),b={init:function(e,t){this.postRawId=t,this.selectFile=this.selectFile.bind(this),this.render=this.render.bind(this),window.cur.storyPublishContext=!0;var r=window.vk.story_publish_web;r&&(t?Object(h.sendStat)(h.EVENTS.ADD_STORY_FROM_SHARING):Object(h.sendStat)(h.EVENTS.ADD_STORY),e?this.render():1===r?this.selectFile():2===r?this.filePickerRender():3===r&&this.render())},render:function(e){var t=document.querySelector(".StoriesPublisher");t||((t=document.createElement("div")).classList.add("StoriesPublisher"),document.body.append(t)),a.render(o.createElement(p,{onClose:this.destroy,photoUrl:e,postRawId:this.postRawId}),t)},selectFile:function(){var e=this;Object(E.uploadLocalImage)().then(function(t){e.render(t)}).catch(function(){window.showFastBox({title:Object(_.getLang)("global_error")},Object(_.getLang)("stories_create_image_incorrect"))})},filePickerRender:function(){var e=this,t=document.querySelector(".StoriesPublisher");t||((t=document.createElement("div")).classList.add("StoriesPublisher"),document.body.append(t)),a.render(o.createElement(g,{onClose:this.destroy,onSelect:this.selectFile,onSkip:function(){return e.render()}}),t)},destroy:function(){var e=document.querySelector(".StoriesPublisher");e&&a.unmountComponentAtNode(e)}};window.StoriesPublisher=b;try{window.stManager.done(window.jsc("web/stories_publisher.js"))}catch(e){}},fjjh:function(e,t,r){"use strict";r.r(t);var n,o=r("q1tI"),a=r("/MKj"),i=r("ANjH"),s=r("/TnQ"),c=r("sINF"),u=r("xYVc"),l=function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},d={isDataLoaded:!1,isShowDropBox:!1,isSaveLoading:!1,currentMode:u.default.TABS.STICKERS,currentStickerPackIndex:0,stickerHeaderScrollPosition:0},f=function(e,t){switch(void 0===e&&(e=d),t.type){case"SET_DATA_LOADED":return l(l({},e),{isDataLoaded:!0});case"SET_SHOW_DROP_BOX":return l(l({},e),{isShowDropBox:t.value});case"SET_SAVE_LOADING":return l(l({},e),{isSaveLoading:t.value});case"SET_CURRENT_TAB":return l(l({},e),{currentMode:t.value});case"SET_CURRENT_STICKER_PACK_INDEX":return l(l({},e),{currentStickerPackIndex:t.value});case"SET_HEADER_SCROLL_POSITION":return l(l({},e),{stickerHeaderScrollPosition:t.value});default:return e}},p=function(){return(p=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},h={color:u.default.COLORS[0],brushWidth:.5,brushOpacity:1,fontSize:.5,fontFamily:u.default.FONTS[0]},m=function(e,t){switch(void 0===e&&(e=h),t.type){case"SET_SETTING_COLOR":return p(p({},e),{color:t.color});case"SET_SETTING_BRUSH_WIDTH":return p(p({},e),{brushWidth:t.brushWidth});case"SET_SETTING_BRUSH_OPACITY":return p(p({},e),{brushOpacity:t.brushOpacity});case"SET_SETTING_FONT_SIZE":return p(p({},e),{fontSize:t.fontSize});case"SET_SETTING_FONT_FAMILY":return p(p({},e),{fontFamily:t.fontFamily});default:return e}},y=function(){return(y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)n[o]=a[i];return n},g={currentIndex:null,items:[]},_=function(e,t){switch(void 0===e&&(e=g),t.type){case"SET_CURRENT_LAYER":return y(y({},e),{currentIndex:t.index});case"ADD_LAYER_STICKER":case"ADD_LAYER_TEXT":return y(y({},e),{items:v(e.items,[t.payload])});case"UPDATE_LAYER":return y(y({},e),{items:e.items.map(function(r,n){return e.currentIndex===n?y(y({},r),t.payload):r})});case"DELETE_LAYER":return{currentIndex:null,items:e.items.filter(function(e,r){return r!==t.index})};default:return e}},E=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)n[o]=a[i];return n},b=function(e,t){switch(void 0===e&&(e=[]),t.type){case"ADD_VECTOR":return E(e,[t.payload]);case"UNDO_DRAWING":return e.filter(function(t,r){return r!==e.length-1});default:return e}},w=function(){return(w=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},O={currentBackgroundType:u.default.BACKGROUND_MODES.PHOTO,currentPhotoUrl:null,currentBackgroundId:1},S=function(e,t){switch(void 0===e&&(e=O),t.type){case"SET_CURRENT_BACKGROUND_TYPE":return w(w({},e),{currentBackgroundType:t.value});case"SET_CURRENT_PHOTO_URL":return w(w({},e),{currentPhotoUrl:t.value});case"SET_CURRENT_BACKGROUND_ID":return w(w({},e),{currentBackgroundId:t.value});default:return e}},T=function(){return(T=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},P=function(e,t){switch(void 0===e&&(e={}),t.type){case"SET_DATA":return T(T({},e),t.payload);default:return e}},C=Object(i.combineReducers)({ui:f,settings:m,layers:_,drawings:b,background:S,data:P}),x=function(e){return Object(i.createStore)(C,e,s.composeWithDevTools(Object(i.applyMiddleware)(c.default)))},N=r("mYgU"),R=r.n(N),L=r("ufMw"),j=r("nAFc"),D=r("jE6c"),k=function(e){return{type:"SET_CURRENT_LAYER",index:e}},I=function(e,t){return function(r,n){var o=n().layers.items;r({type:e,payload:t}),r(k(o.length))}},A=function(){return function(e,t){var r=t(),n=r.data,o=r.settings,a=Object(j.decodeHTMLEntities)(n.placeholders[Object(D.irand)(0,n.placeholders.length-1)]);Object(L.sendStat)(L.EVENTS.ADD_TEXT),e(H(u.default.TABS.TEXT)),e(I("ADD_LAYER_TEXT",{type:u.default.LAYER_TYPES.TEXT,text:a,x:n.artboardWidth/2,y:n.artboardHeight/2,rotate:0,isFixed:!1,isEdit:!0,fontSize:o.fontSize,fontFamily:o.fontFamily,color:o.color,scale:1}))}},M=function(e){return function(t,r){var n=r().layers,o=n.currentIndex,a=n.items;null!==o&&a[o]&&t({type:"UPDATE_LAYER",payload:e})}},B=function(){return function(e,t){var r=t().layers,n=r.currentIndex,o=r.items;if(null!==n){var a=o[n];a&&(a.type===u.default.LAYER_TYPES.STICKER?Object(L.sendStat)(L.EVENTS.DELETE_STICKER):a.type===u.default.LAYER_TYPES.TEXT&&Object(L.sendStat)(L.EVENTS.DELETE_TEXT),e(U(!1)),e({type:"DELETE_LAYER",index:n}))}}},F=function(){return function(e,t){var r=t().layers,n=r.currentIndex,o=r.items;if(null!==n){var a=o[n];a&&a.type===u.default.LAYER_TYPES.TEXT&&(o[n].text.trim()?e(M({isEdit:!1})):e(B()))}}},U=function(e){return{type:"SET_SHOW_DROP_BOX",value:e}},H=function(e){return function(t,r){var n=r().layers,o=n.items,a=n.currentIndex;null!==a&&(o[a].type===u.default.LAYER_TYPES.TEXT&&t(F()),e===u.default.TABS.PAINT&&t(k(null))),t({type:"SET_CURRENT_TAB",value:e})}},Y=function(e){return function(t,r){var n=r().layers,o=n.currentIndex,a=n.items;o&&!a[o]||t(M({color:e})),t({type:"SET_SETTING_COLOR",color:e})}},W=function(){return Object(L.sendStat)(L.EVENTS.CANCEL_GRAFFITI),{type:"UNDO_DRAWING"}},K=r("i8i4"),G=r("Qc8c"),X=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),V=function(e){function t(t){var r=e.call(this,t)||this;return r.shouldComponentUpdate=function(e){return r.props.drawings.length!==e.drawings.length&&r.renderDrawings(e.drawings),!1},r.renderDrawings=function(e){var t=r.canvas.current;if(t){var n=t.getContext("2d");if(n){var o=r.props.data.originalHeight/r.props.height;n.clearRect(0,0,t.width,t.height),n.lineCap="round",n.lineJoin="round",e.forEach(function(e){n.lineWidth=e.width*u.default.BRUSH_WIDTH_COEFFICIENT*o,n.strokeStyle=Object(G.hexToRgba)(e.color,e.opacity),n.beginPath(),n.moveTo(e.path[0][0]*o,e.path[0][1]*o),e.path.forEach(function(e){n.lineTo(e[0]*o,e[1]*o)}),n.stroke()})}}},r.drawStart=function(e){if(r.props.ui.currentMode===u.default.TABS.PAINT){window.addEventListener("mousemove",r.drawProcess),window.addEventListener("mouseup",r.drawFinish);var t=Object(G.getRelativeXY)(e.nativeEvent,r.canvas.current),n=t.x,o=t.y;r.currentDrawing=[[n,o]];var a=r.props.settings;r.props.addDrawing({color:a.color,width:a.brushWidth,opacity:a.brushOpacity,path:r.currentDrawing}),r.renderDrawings(r.props.drawings)}},r.drawProcess=function(e){var t=Object(G.getRelativeXY)(e,r.canvas.current),n=t.x,o=t.y;r.currentDrawing.push([n,o]),r.renderDrawings(r.props.drawings)},r.drawFinish=function(){window.removeEventListener("mousemove",r.drawProcess),window.removeEventListener("mouseup",r.drawFinish),r.currentDrawing=[]},r.canvasDoubleClick=function(){r.props.ui.currentMode!==u.default.TABS.PAINT&&r.props.addLayerText()},r.canvas=o.createRef(),r.currentDrawing=[],r}return X(t,e),t.prototype.render=function(){var e=this.props,t=e.data,r=e.width,n=e.height;return o.createElement("canvas",{ref:this.canvas,className:"EditorCanvas__canvas EditorCanvas__canvas--draw",onDoubleClick:this.canvasDoubleClick,onMouseDown:this.drawStart,width:t.originalWidth,height:t.originalHeight,style:{width:r,height:n}})},t}(o.Component),q=Object(a.connect)(function(e){return{ui:e.ui,settings:e.settings,drawings:e.drawings,data:e.data}},function(e){return{addDrawing:function(t){return e(function(e){return Object(L.sendStat)(L.EVENTS.ADD_GRAFFITI),{type:"ADD_VECTOR",payload:e}}(t))},addLayerText:function(){return e(A())}}})(V),z=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)n[o]=a[i];return n},Z=function(e){function t(t){var r=e.call(this,t)||this;return r.shouldComponentUpdate=function(e){var t=r.props.background;return t.currentBackgroundId===e.background.currentBackgroundId&&t.currentBackgroundType===e.background.currentBackgroundType&&t.currentPhotoUrl===e.background.currentPhotoUrl||r.renderImage(e.background),!1},r.getBackgroundById=function(e){var t=r.props.data.backgrounds,n=t.gradients,o=t.emojies;return $(n,o).filter(function(t){return t.id===e})[0]},r.getCurrentImageUrl=function(e){var t,n=e||r.props.background,o=n.currentBackgroundType,a=n.currentPhotoUrl,i=n.currentBackgroundId;o===u.default.BACKGROUND_MODES.PHOTO?t=a:t=r.getBackgroundById(i).url;return t},r.renderImage=function(e){var t=r.canvas.current;if(t){var n=r.getCurrentImageUrl(e);n&&Object(G.loadImage)(n).then(function(e){var r=t.getContext("2d");if(r){var n=+(e.height/e.width).toFixed(2),o=t.width,a=t.height;if(e.width<t.width&&e.height<t.height?(o=e.width,a=e.height):a=t.width*n,r.save(),r.clearRect(0,0,t.width,t.height),r.filter="blur(135px)",r.drawImage(e,0,0,t.width,t.height),r.restore(),"none"!==r.filter){var i=Object(G.getAverageRGB)(r);r.fillStyle="rgb("+i.r+", "+i.g+", "+i.b+")",r.fillRect(0,0,t.width,t.height)}r.drawImage(e,t.width/2-o/2,t.height/2-a/2,o,a)}}).catch(function(e){console.error(e)})}},r.canvas=o.createRef(),r}return z(t,e),t.prototype.componentDidMount=function(){this.renderImage()},t.prototype.render=function(){var e=this.props.data;return o.createElement("canvas",{ref:this.canvas,className:"EditorCanvas__canvas EditorCanvas__canvas--bg",width:e.originalWidth,height:e.originalHeight,style:{width:this.props.width,height:this.props.height}})},t}(o.Component),J=Object(a.connect)(function(e){return{data:e.data,background:e.background}})(Z),Q=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controlMouseDown=function(e,r){if(e.preventDefault(),e.stopPropagation(),t.layer=t.props.layer,t.layer.type===u.default.LAYER_TYPES.TEXT){var n=e.target.closest(".EditorLayer__inner");if(!n)return;t.width=n.offsetWidth,t.height=n.offsetHeight}else t.width=t.layer.width,t.height=t.layer.height;if(void 0!==t.width&&void 0!==t.height){switch(window.addEventListener("mousemove",t.controlMouseMove),window.addEventListener("mouseup",t.controlMouseUp),r){case"se":t.offsetFromCenter={x:t.width/2,y:t.height/2};break;case"sw":t.offsetFromCenter={x:-t.width/2,y:t.height/2};break;case"ne":t.offsetFromCenter={x:t.width/2,y:-t.height/2};break;case"nw":t.offsetFromCenter={x:-t.width/2,y:-t.height/2}}void 0!==t.offsetFromCenter&&(t.distanceToZero=Math.sqrt(t.offsetFromCenter.x*t.offsetFromCenter.x+t.offsetFromCenter.y*t.offsetFromCenter.y))}},t.controlMouseMove=function(e){var r=Object(G.getRelativeXY)(e,document.querySelector(".EditorCanvas__canvas--draw")),n=r.x,o=r.y;if(void 0!==t.offsetFromCenter&&void 0!==t.distanceToZero&&void 0!==t.width&&void 0!==t.height){var a={x:n-t.layer.x,y:o-t.layer.y},i=180*(Math.atan2(a.y,a.x)-Math.atan2(t.offsetFromCenter.y,t.offsetFromCenter.x))/Math.PI,s=Math.max(u.default.LAYER_MIN_SIZE,Math.sqrt(a.x*a.x+a.y*a.y))/t.distanceToZero,c=Math.floor(t.width*s),l=Math.floor(t.height*s);t.layer.type===u.default.LAYER_TYPES.TEXT?t.props.updateLayer({fontSize:t.layer.fontSize*s,rotate:i}):t.props.updateLayer({width:c,height:l,rotate:i})}},t.controlMouseUp=function(){window.removeEventListener("mousemove",t.controlMouseMove),window.removeEventListener("mouseup",t.controlMouseUp),delete t.width,delete t.height,delete t.centerCoordinates,delete t.offsetFromCenter,delete t.distanceToZero},t}return Q(t,e),t.prototype.render=function(){var e=this;return o.createElement("div",{className:"EditorLayerSelection"},o.createElement("div",{className:"EditorLayerSelection__handler EditorLayerSelection__handler--nw",onMouseDown:function(t){return e.controlMouseDown(t,"nw")}}),o.createElement("div",{className:"EditorLayerSelection__handler EditorLayerSelection__handler--ne",onMouseDown:function(t){return e.controlMouseDown(t,"ne")}}),o.createElement("div",{className:"EditorLayerSelection__handler EditorLayerSelection__handler--sw",onMouseDown:function(t){return e.controlMouseDown(t,"sw")}}),o.createElement("div",{className:"EditorLayerSelection__handler EditorLayerSelection__handler--se",onMouseDown:function(t){return e.controlMouseDown(t,"se")}}))},t}(o.Component),te=r("pemR"),re=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderLayerSticker=function(e,r,n){var a=t.props.getStickerUrlById(e.id,u.default.STICKER_LARGE);return o.createElement("div",{key:r,className:n,"data-index":r,style:{width:1,height:1,transform:"translate("+e.x+"px, "+e.y+"px) rotateZ("+e.rotate+"deg)"}},o.createElement("div",{className:"EditorLayer__inner",style:{width:e.width,height:e.height,backgroundImage:"url('"+a+"')"}},t.props.currentIndex===r&&o.createElement(ee,{layer:e,updateLayer:t.props.updateLayer})))},t.renderLayerText=function(e,r,n){var a={fontSize:Math.max(10,e.fontSize*e.scale*u.default.FONT_SIZE_COEFFICIENT),fontFamily:e.fontFamily+", serif",color:e.color};return t.props.currentIndex===r&&e.isEdit?null:o.createElement("div",{key:r,className:n,"data-index":r,style:{width:1,height:1,transform:"translate("+e.x+"px, "+e.y+"px) rotateZ("+e.rotate+"deg)"}},o.createElement("div",{className:"EditorLayer__inner",style:a,onDoubleClick:t.handleDoubleClick},o.createElement("span",null,Object(j.decodeHTMLEntities)(e.text.replace(/(\v)/gm,"\n"))),t.props.currentIndex===r&&o.createElement(ee,{layer:e,updateLayer:t.props.updateLayer})))},t.handleDoubleClick=function(){t.props.updateLayer({isEdit:!0})},t}return re(t,e),t.prototype.render=function(){var e=this.props,t=e.layer,r=e.currentIndex,n=e.index,o=null,a=Object(te.classNames)("EditorLayer","EditorLayer--"+t.type,{"EditorLayer--active":r===n,"EditorLayer--drag":t.isFixed,"EditorLayer--hide":t.isHide});switch(t.type){case u.default.LAYER_TYPES.STICKER:o=this.renderLayerSticker(t,n,a);break;case u.default.LAYER_TYPES.TEXT:o=this.renderLayerText(t,n,a)}return t.isFixed?K.createPortal(o,document.body):o},t}(o.Component),oe=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oe(t,e),t.prototype.render=function(){var e=this,t=this.props.layers,r=t.items,n=t.currentIndex,a=Object(te.classNames)("EditorCanvas__layers",{"EditorCanvas__layers--disabled":this.props.currentMode===u.default.TABS.PAINT});return o.createElement("div",{className:a,id:"EditorCanvas__layers"},r.map(function(t,r){return o.createElement(ne,{key:r,index:r,currentIndex:n,layer:t,updateLayer:e.props.updateLayer,getStickerUrlById:e.props.getStickerUrlById})}))},t}(o.Component),ie=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),se=function(e){function t(t){var r=e.call(this,t)||this;return r.componentDidMount=function(){var e=r.textareaEl.current;e&&(r.onChange(),e.select())},r.render=function(){var e=r.props.layer,t=.5*u.default.FONT_SIZE_COEFFICIENT;return o.createElement("div",{className:"EditorText"},o.createElement("div",{className:"EditorText__inner"},o.createElement("textarea",{ref:r.textareaEl,className:"EditorText__textarea",defaultValue:Object(j.decodeHTMLEntities)(e.text).replace(/(\v)/gm,""),autoFocus:!0,onChange:r.onChange,onInput:r.onChange,onPaste:r.onChange,style:{color:e.color,fontFamily:e.fontFamily,fontSize:t,height:r.state.height}})))},r.onChange=function(){var e=r.textareaEl.current;e&&(r.setState({height:0},function(){r.setState({height:e.scrollHeight})}),r.props.onChange(r.applyLineBreaks(e)))},r.applyLineBreaks=function(e){var t=e.value,r=e.cloneNode(!0);document.querySelector(".EditorText__inner").appendChild(r),r.setAttribute("wrap","off"),r.value="";for(var n=r.scrollWidth,o=0,a=-1;o<t.length;o++){var i=t.charAt(o);if(" "!=i&&"-"!=i&&"+"!=i||(a=o),r.value+=i,r.scrollWidth>n){var s="";if(a>=0){for(var c=a+1;c<o;c++)s+=t.charAt(c);a=-1}s+=i,r.value=r.value.substr(0,r.value.length-s.length),r.value+="\n\v"+s}}return r.remove(),r.value.replace(/(\n\v)/gm,"\v")},r.state={height:0},r.textareaEl=o.createRef(),Object(L.sendStat)(L.EVENTS.EDIT_TEXT),r}return ie(t,e),t.prototype.componentDidUpdate=function(e){e.layer.fontFamily!==this.props.layer.fontFamily&&this.onChange()},t}(o.Component),ce=r("4+be"),ue=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),le=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)n[o]=a[i];return n},de=function(e){function t(t){var r=e.call(this,t)||this;return r.componentDidUpdate=function(){r.scrollWithAnimation=!1},r.render=function(){var e,t=r.props.layers,n=t.currentIndex,a=t.items,i=null!==n&&a[n],s=i&&i.type===u.default.LAYER_TYPES.TEXT&&i.isEdit,c=i&&i.type===u.default.LAYER_TYPES.STICKER&&i.isHide,l="";return i&&(i.type===u.default.LAYER_TYPES.STICKER?l=Object(ce.getLang)("photos_pe_delete_sticker"):i.type===u.default.LAYER_TYPES.TEXT&&(l=Object(ce.getLang)("photos_pe_delete_text"))),r.props.currentBackgroundType!==u.default.BACKGROUND_MODES.BACKGROUND||i||(e=!0),o.createElement("div",{className:"StatusPanel"},e?r.renderBackgrounds():o.createElement("div",{className:"StatusPanel__inner"},r.renderLeftBlock(),o.createElement("div",null,i&&!s&&!c&&o.createElement("a",{className:"StatusPanel__link",onClick:r.props.deleteLayer},l),i&&s&&o.createElement("a",{className:"StatusPanel__link",onClick:r.props.closeTextEditor},Object(ce.getLang)("photos_pe_save_action")))))},r.renderLeftBlock=function(){var e=r.props.addons;return"photo"===r.props.context?o.createElement("div",null,e&&e.edited&&e.canEdit&&o.createElement("a",{className:"StatusPanel__link",onClick:e.restore},Object(ce.getLang)("photos_filtered_restore")),e&&!e.canEdit&&o.createElement("span",{className:"StatusPanel__info"},Object(ce.getLang)("photos_will_be_saved_to_pe_album"))):o.createElement("div",null,r.props.currentBackgroundType===u.default.BACKGROUND_MODES.PHOTO&&o.createElement("a",{className:"StatusPanel__link",onClick:function(){return r.props.uploadPhoto()}},Object(ce.getLang)("photos_pe_change_photo")))},r.renderBackgrounds=function(){var e=r.state.scrollBlockPosition,t=r.props.backgrounds||{},n=t.gradients,a=void 0===n?{}:n,i=t.emojies,s=void 0===i?{}:i,c=r.scrollElement.current,u=c?e+c.offsetWidth:0,l=!!e,d=!c||!!(c.scrollWidth-u);return o.createElement("div",{className:"StatusPanel__backgrounds",onWheel:r.panelMouseWheel},o.createElement("div",{className:"StatusPanel__scroll",style:{transform:"translateX(-"+e+"px)",transition:r.scrollWithAnimation?"transform .3s ease-out":""},ref:r.scrollElement},le(a,s).map(function(e){var t=e.id,n=e.preview;return o.createElement("a",{className:Object(te.classNames)("StatusPanel__background",{"StatusPanel__background--active":t===r.props.currentBackgroundId}),key:t,style:{backgroundImage:"url("+n+")"},onClick:function(){return r.props.setCurrentBackgroundId(t)}})})),l&&o.createElement("div",{className:"StatusPanel__arrow StatusPanel__arrow--left",onClick:function(){return r.handleArrowClick(!0)}},o.createElement("span",{className:"StatusPanel__arrowIcon"})),d&&o.createElement("div",{className:"StatusPanel__arrow StatusPanel__arrow--right",onClick:function(){return r.handleArrowClick(!1)}},o.createElement("span",{className:"StatusPanel__arrowIcon"})))},r.panelMouseWheel=function(e){r.setPosition(Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX)},r.setPosition=function(e,t){var n=r.scrollElement.current;if(n){var o=r.state.scrollBlockPosition,a=n.offsetWidth,i=Math.max(0,Math.min(o+e,n.scrollWidth-a));t&&(r.scrollWithAnimation=!0),r.setState({scrollBlockPosition:i})}},r.handleArrowClick=function(e){var t=r.scrollElement.current;if(t){var n=t.offsetWidth/2;e&&(n=-n),r.setPosition(n,!0)}},r.state={scrollBlockPosition:0},r.scrollElement=o.createRef(),r.scrollWithAnimation=!1,r}return ue(t,e),t}(o.Component),fe=Object(a.connect)(function(e){return{context:e.data.context,layers:e.layers,addons:e.data.addons}},function(e){return{deleteLayer:function(){return e(B())},closeTextEditor:function(){return e(F())}}})(de),pe=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setMode=function(e){e===u.default.BACKGROUND_MODES.PHOTO?Object(L.sendStat)(L.EVENTS.CLICK_TO_CAMERA_ICON):e===u.default.BACKGROUND_MODES.BACKGROUND&&Object(L.sendStat)(L.EVENTS.CLICK_TO_GRADIENT_ICON),t.props.setMode(e)},t}return pe(t,e),t.prototype.render=function(){var e=this;return o.createElement("div",{className:"SwitchMode"},Object.values(u.default.BACKGROUND_MODES).map(function(t){var r=Object(te.classNames)("SwitchMode__mode","SwitchMode__mode--"+t,{"SwitchMode__mode--active":t===e.props.current});return o.createElement("span",{key:t,className:r,onClick:function(){return e.setMode(t)}})}))},t}(o.Component),me=r("T/g7"),ye=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ve=r("XpgC").default,ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){var e=t.props.data.artboardContainer;return e?K.createPortal(t.renderCanvas(),e):t.renderCanvas()},t.renderCanvas=function(){var e=t.props,r=e.layers,n=e.background,a=e.data,i=a.addons,s=a.artboardWidth,c=a.artboardHeight,l=t.props.layers,d=l.currentIndex,f=l.items,p=null!==d&&f[d],h=p&&p.type===u.default.LAYER_TYPES.TEXT&&p.isEdit,m=t.props.ui.isDataLoaded&&t.props.data.context===u.default.CONTEXT_TYPES.STORY,y=c;i&&i.photoHeight&&(y=i.photoHeight);var v=0;i&&i.photoOffsetTop&&(v=i.photoOffsetTop);var g=!1;return i&&i.postRawId&&(g=!0),o.createElement(o.Fragment,null,o.createElement("div",{style:{width:s,height:y,marginTop:v},className:"EditorCanvas"},o.createElement(ae,{updateLayer:t.props.updateLayer,currentMode:t.props.ui.currentMode,getStickerUrlById:t.props.getStickerUrlById,layers:r}),h&&p?o.createElement(se,{layer:p,onChange:t.onChangeText}):m&&o.createElement(o.Fragment,null,g&&o.createElement(ve,{text:Object(me.getLang)("photos_pe_attached_post"),position:"b",marginTop:5,align:"left"},o.createElement("span",{className:"EditorCanvas__postIcon"})),o.createElement(he,{current:n.currentBackgroundType,setMode:t.setMode})),t.props.ui.isDataLoaded&&o.createElement(q,{width:s,height:y}),t.props.ui.isDataLoaded&&o.createElement(J,{width:s,height:y})),t.props.ui.isDataLoaded&&o.createElement(fe,{currentBackgroundId:n.currentBackgroundId,setCurrentBackgroundId:t.props.setCurrentBackgroundId,currentBackgroundType:n.currentBackgroundType,uploadPhoto:t.uploadPhoto,backgrounds:t.props.data.backgrounds}))},t.onChangeText=function(e){t.props.updateLayer({text:e})},t.setMode=function(e){var r=t.props.background,n=r.currentBackgroundType,o=r.currentPhotoUrl;t.props.setCurrentLayer(null),e===u.default.BACKGROUND_MODES.PHOTO&&!o||n===u.default.BACKGROUND_MODES.PHOTO&&n===e?t.uploadPhoto(function(){t.props.setBackgroundType(e)}):t.props.setBackgroundType(e)},t.uploadPhoto=function(e){Object(G.uploadLocalImage)().then(function(r){e&&e(),t.props.setCurrentPhotoUrl(r)}).catch(function(){window.showFastBox({title:Object(me.getLang)("global_error")},Object(me.getLang)("stories_create_image_incorrect"))})},t}return ye(t,e),t}(o.Component),_e=Object(a.connect)(function(e){return{ui:e.ui,settings:e.settings,layers:e.layers,drawings:e.drawings,background:e.background,data:e.data}},function(e){return{setCurrentBackgroundId:function(t){return e(function(e){return Object(L.sendStat)(L.EVENTS.SELECT_BACKGROUND),{type:"SET_CURRENT_BACKGROUND_ID",value:e}}(t))},updateLayer:function(t){return e(M(t))},setCurrentLayer:function(t){return e(k(t))},setBackgroundType:function(t){return e({type:"SET_CURRENT_BACKGROUND_TYPE",value:t})},setCurrentPhotoUrl:function(t){return e(function(e){return{type:"SET_CURRENT_PHOTO_URL",value:e}}(t))}}})(ge),Ee=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.render=function(){var e=this.props,t=e.current,r=e.change;return o.createElement("div",{className:"EditorTabs"},o.createElement("div",{className:"EditorTabs__header"},o.Children.map(this.props.children,function(e){var n=Object(te.classNames)("EditorTabs__item","EditorTabs__item--"+e.props["data-mode"],{"EditorTabs__item--current":t===e.props["data-mode"]});return o.createElement("div",{className:n,key:e.props["data-mode"],onClick:function(){return r(e.props["data-mode"])}})})),o.createElement("div",{className:"EditorTabs__content"},o.Children.map(this.props.children,function(e){var r={className:Object(te.classNames)(e.props.className,"EditorTabs__tab",{"EditorTabs__tab--current":t===e.props["data-mode"]})};return o.cloneElement(e,r)})))},t}(o.Component),we=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Oe=function(e){function t(t){var r=e.call(this,t)||this;return r.state={onHover:!1},r}return we(t,e),t.prototype.render=function(){var e=this,t=Object(te.classNames)("DropBox__inner",{"DropBox__inner--hover":this.state.onHover});return o.createElement("div",{className:"DropBox"},o.createElement("div",{className:t,onMouseOver:function(){return e.setState({onHover:!0})},onMouseOut:function(){return e.setState({onHover:!1})},onMouseUp:this.props.onDelete},o.createElement("div",{className:"DropBox__icon"},this.renderIcon()),o.createElement("span",{dangerouslySetInnerHTML:{__html:Object(me.getLang)("photos_pe_drag_to_remove")}})))},t.prototype.renderIcon=function(){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"50px",height:"50px",viewBox:"0 0 50 50"},o.createElement("path",{d:"M15 19H35V37C35 38.1 34.1 39 33 39H17C15.9 39 15 38.1 15 37V19Z",fill:"white"}),o.createElement("path",{d:"M37 15C37 13.9 36.1 13 35 13H28.4C28.4 11.9 27.5 11 26.4 11H23.6C22.5 11 21.6 11.9 21.6 13H15C13.9 13 13 13.9 13 15C13 15 13 13.5 13 15V17H37V15C37 15 37 13.4 37 15Z",fill:"white",className:"cap"}))},t}(o.Component),Se=r("t7n3"),Te=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pe=r("vRp6").default,Ce=function(e){function t(t){var r=e.call(this,t)||this;return r.componentDidMount=function(){r.setState({})},r.componentDidUpdate=function(){r.scrollWithAnimation=!1},r.render=function(){var e=r.props,t=e.stickers,n=e.stickerMouseDown,a=r.props.ui,i=a.stickerHeaderScrollPosition,s=a.currentStickerPackIndex,c=r.scrollElement.current,l=!!i,d=!1,f=0;c&&(f=i+c.offsetWidth,d=!!(c.scrollWidth-f));var p=t[s]?t[s].items:[];r.needReset&&(r.needReset=!1,p=[],r.setState({}));for(var h=[],m=0,y=p.length;m<y;m+=3)h.push(p.slice(m,m+3));return o.createElement("div",{className:"StickersPanel"},r.props.ui.isShowDropBox&&o.createElement(Oe,{onDelete:r.props.deleteLayer}),o.createElement("div",{className:"StickersPanel__header"},o.createElement("div",{className:"StickersPanel__scroll",style:{transform:"translateX(-"+i+"px)",transition:r.scrollWithAnimation?"transform .3s ease-out":""},ref:r.scrollElement,onWheel:r.tabsMouseWheel},t.map(function(e,t){var n=e.id,a=r.getTabPreviewUrl(t);if(!a)return null;var i=!Object(Se.inArray)(n,["recent","editor"]),c=Object(te.classNames)("StickersPanel__tab",{"StickersPanel__tab--selected":t===s,"StickersPanel__tab--recent":"recent"===n,"StickersPanel__tab--editor":"editor"===n});return o.createElement("div",{key:n,className:c,style:i?{backgroundImage:"url('"+a+"')"}:void 0,onClick:function(){return r.selectStickerPack(t)}})})),l&&o.createElement("div",{className:"StickersPanel__arrow StickersPanel__arrow--left",onClick:function(){return r.handleTabArrowClick(!0)}},o.createElement("span",{className:"StickersPanel__arrowIcon"})),d&&o.createElement("div",{className:"StickersPanel__arrow StickersPanel__arrow--right",onClick:function(){return r.handleTabArrowClick(!1)}},o.createElement("span",{className:"StickersPanel__arrowIcon"}))),o.createElement(Pe,{virtualized:!0,loadMore:function(){},hasMore:!1,className:"StickersPanel__content",itemHeight:98},h.map(function(e,t){return o.createElement("div",{key:t,className:"StickersPanel__row"},e.map(function(e){var t=e.id,r=e.sizes;return o.createElement("div",{key:t,className:"StickersPanel__preview",onMouseDown:function(e){return n(e,t)}},o.createElement("img",{src:r[u.default.STICKER_MEDIUM],className:"StickersPanel__previewImage"}))}))})))},r.getTabPreviewUrl=function(e){var t=r.props.stickers[e].items,n=(t||[])[0],o=void 0===n?null:n;return!(!t||!o)&&o.sizes[u.default.STICKER_SMALL]},r.selectStickerPack=function(e){r.needReset=!0,r.props.setCurrentStickerPackIndex(e)},r.tabsMouseWheel=function(e){r.setPosition(Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX)},r.handleTabArrowClick=function(e){var t=r.scrollElement.current;if(t){var n=t.offsetWidth;e&&(n=-n),r.setPosition(n,!0)}},r.setPosition=function(e,t){var n=r.scrollElement.current,o=r.props.ui.stickerHeaderScrollPosition;if(n){var a=n.offsetWidth,i=Math.max(0,Math.min(o+e,n.scrollWidth-a));t&&(r.scrollWithAnimation=!0),r.props.setHeaderScrollPosition(i)}},r.loadingLimit=25,r.scrollElement=o.createRef(),r.scrollWithAnimation=!1,r.needReset=!1,r}return Te(t,e),t}(o.Component),xe=Object(a.connect)(function(e){return{ui:e.ui,stickers:e.data.stickers}},function(e){return{deleteLayer:function(){return e(B())},setCurrentStickerPackIndex:function(t){return e(function(e){return{type:"SET_CURRENT_STICKER_PACK_INDEX",value:e}}(t))},setHeaderScrollPosition:function(t){return e(function(e){return{type:"SET_HEADER_SCROLL_POSITION",value:e}}(t))}}})(Ce),Ne=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ne(t,e),t.prototype.render=function(){var e=this;return o.createElement("div",{className:"ColorPicker"},u.default.COLORS.map(function(t){var r=Object(te.classNames)("ColorPicker__color",{"ColorPicker__color--white":"#FFFFFF"===t,"ColorPicker__color--selected":t===e.props.color});return o.createElement("div",{key:t,className:r,style:{backgroundColor:t},onClick:function(){return e.props.setColor(t)}})}))},t}(o.Component),Le=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),je=r("Cb16").default,De=function(e){function t(t){var r=e.call(this,t)||this;return r.componentDidMount=function(){r.updateDrawingPreview()},r.render=function(){var e=r.props,t=e.settings,n=e.setColor,a=e.setBrushWidth,i=e.setBrushOpacity;return r.updateDrawingPreview(),o.createElement("div",{className:"DrawPanel"},o.createElement("canvas",{ref:r.previewCanvas,className:"DrawPanel__preview",width:"270",height:"80"}),o.createElement("div",{className:"DrawPanel__sliders"},o.createElement("div",{className:"DrawPanel__slider"},o.createElement("div",{className:"DrawPanel__sliderTitle"},Object(me.getLang)("photos_pe_intensity")),o.createElement(je,{color:"#5181b8",defaultValue:t.brushOpacity,formatHint:function(e){return Math.round(100*e)+"%"},onChange:function(e){return i(e)}})),o.createElement("div",{className:"DrawPanel__slider"},o.createElement("div",{className:"DrawPanel__sliderTitle"},Object(me.getLang)("photos_pe_line_width")),o.createElement(je,{color:"#5181b8",defaultValue:t.brushWidth,onChange:function(e){return a(e)}}))),o.createElement(Re,{color:t.color,setColor:n}),!!r.props.drawings.length&&o.createElement("div",{className:"DrawPanel__undo",onClick:r.undoDrawing},Object(me.getLang)("photos_pe_undo_last_action")))},r.updateDrawingPreview=function(){var e=r.previewCanvas.current,t=r.props.settings;if(e){var n=e.getContext("2d");if(n){var o=n.canvas,a=o.width,i=o.height,s=.2*a,c=.25*i,l=.8*a,d=c,f=a/2,p=1.2*i;n.clearRect(0,0,a,i),n.beginPath(),n.moveTo(s,c),n.quadraticCurveTo(f,p,l,d);var h="#FFFFFF"===t.color?"#F1F1F1":t.color;n.lineWidth=t.brushWidth*u.default.BRUSH_WIDTH_COEFFICIENT,n.strokeStyle=Object(G.hexToRgba)(h,t.brushOpacity),n.lineJoin=n.lineCap="round",n.stroke()}}},r.undoDrawing=function(){r.props.undoDrawing()},r.previewCanvas=o.createRef(),r}return Le(t,e),t}(o.Component),ke=Object(a.connect)(function(e){return{settings:e.settings,drawings:e.drawings}},function(e){return{setColor:function(t){return e(Y(t))},setBrushWidth:function(t){return e(function(e){return{type:"SET_SETTING_BRUSH_WIDTH",brushWidth:Math.max(.1,e)}}(t))},setBrushOpacity:function(t){return e(function(e){return{type:"SET_SETTING_BRUSH_OPACITY",brushOpacity:e}}(t))},undoDrawing:function(){return e(W())}}})(De),Ie=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ae=r("Hx9h").default,Me=r("TBLV").default,Be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.render=function(){var e=t.props,r=e.settings,n=e.setColor,a=e.layer,i=e.fontsPlaceholders,s=a&&a.isEdit,c=a&&a.fontFamily,l=a&&a.color;return o.createElement("div",{className:"TextPanel"},t.props.ui.isShowDropBox&&o.createElement(Oe,{onDelete:t.props.deleteLayer}),s?o.createElement(Ae,{className:"TextPanelButton",onClick:t.props.closeTextEditor},Object(ce.getLang)("photos_pe_save_action")):o.createElement(Ae,{className:"TextPanelButton",onClick:t.props.addLayerText},o.createElement("div",{className:"TextPanelButton__icon"}),Object(ce.getLang)("photos_pe_add_text")),o.createElement("div",{className:"TextPanelButton__fonts"},o.createElement("div",{className:"TextPanelButton__title"},Object(ce.getLang)("photos_pe_font")),u.default.FONTS.map(function(e,n){return o.createElement(Me,{key:e,value:e,name:"photo_editor_fonts",className:"TextPanelButton__radio",onChange:function(){return t.props.setFontFamily(e)},checked:c?c===e:r.fontFamily===e},o.createElement("span",{className:"TextPanelButton__font",style:{fontFamily:e}},i[n]))})),o.createElement("div",{className:"TextPanelButton__colors"},o.createElement("div",{className:"TextPanelButton__title"},Object(ce.getLang)("photos_pe_color")),o.createElement(Re,{color:l||r.color,setColor:n})))},t}return Ie(t,e),t}(o.Component),Fe=Object(a.connect)(function(e){var t=e.layers,r=t.items,n=t.currentIndex,o=null;return null!==n&&(o=r[n]),{ui:e.ui,settings:e.settings,layer:o,fontsPlaceholders:e.data.fontsPlaceholders}},function(e){return{addLayerText:function(){return e(A())},setColor:function(t){return e(Y(t))},setFontSize:function(t){return e(function(e){return function(t,r){var n=r().layers,o=n.currentIndex,a=n.items;o&&!a[o]||t(M({fontSize:e})),t({type:"SET_SETTING_FONT_SIZE",fontSize:e})}}(t))},setFontFamily:function(t){return e(function(e){return function(t,r){var n=r().layers,o=n.currentIndex,a=n.items;o&&!a[o]||t(M({fontFamily:e})),t({type:"SET_SETTING_FONT_FAMILY",fontFamily:e})}}(t))},deleteLayer:function(){return e(B())},closeTextEditor:function(){return e(F())}}})(Be),Ue=r("3oLO"),He=r("Egk5"),Ye=r("zxIV"),We=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ke=r("Hx9h").default,Ge=r("6raB").default,Xe=r("PjZB").default,Ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.componentDidMount=function(){window.addEventListener("keydown",t.handleKeyDown),window.addEventListener("mousedown",t.canvasMouseDown),t.getEditorData().then(function(e){var r=e.stickers,n=e.backgrounds,o=e.hash,a={};r.forEach(function(e){e.items.forEach(function(e){a[e.id]=e})}),t.props.setData({stickers:r,stickersMap:a,backgrounds:n,placeholders:Object(me.getLang)("photos_pe_texts_placeholders").split("<br>"),fontsPlaceholders:Object(me.getLang)("photos_pe_fonts").split("<br>"),hash:o}),t.props.setDataLoaded(),t.props.background.currentBackgroundType===u.default.BACKGROUND_MODES.BACKGROUND&&(t.props.addLayerText(),t.props.closeTextEditor(),t.props.setCurrentLayer(null))}).catch(function(){window.showFastBox({title:Object(me.getLang)("global_error")},Object(me.getLang)("global_error"),Object(me.getLang)("global_close"),function(){window.curBox().hide(),t.props.data.close(!1,!0)})})},t.componentWillUnmount=function(){window.removeEventListener("keydown",t.handleKeyDown),window.removeEventListener("mousedown",t.canvasMouseDown),delete window.cur.storyPublishContext},t.getEditorData=function(){return new Promise(function(e,t){Ue.ajax.post("al_photos.php",{act:"get_editor_data"},{onDone:function(t){e(t)},onFail:function(){return t(),!0}})})},t.render=function(){var e,r=t.props,n=r.ui,a=r.data,i=r.drawings,s=r.layers;return a.artboardContainer||(e={width:a.artboardWidth,height:parseInt(a.artboardHeight)+u.default.BOTTOM_PANEL_HEIGHT}),t.isSaveDisabled=!0,a.context===u.default.CONTEXT_TYPES.STORY?t.isSaveDisabled=!1:t.isSaveDisabled=!s.items.length&&!i.length,o.createElement("div",{className:"PhotoEditor",style:{height:parseInt(a.artboardHeight)+u.default.BOTTOM_PANEL_HEIGHT}},o.createElement("div",{className:"PhotoEditor__canvas",style:e},o.createElement(_e,{getStickerUrlById:t.getStickerUrlById})),o.createElement("div",{className:"PhotoEditor__tabs"},n.isDataLoaded?t.renderTabs():o.createElement(Xe,null)),!n.isDataLoaded&&t.renderFontsPreloading())},t.renderTabs=function(){var e=Object(me.getLang)("photos_pe_save_action");return t.props.data.context===u.default.CONTEXT_TYPES.STORY&&(e=Object(me.getLang)("photos_pe_publish_action")),o.createElement("div",{className:"PhotoEditor__inner"},o.createElement(be,{current:t.props.ui.currentMode,change:t.props.setMode},o.createElement("div",{"data-mode":u.default.TABS.STICKERS},o.createElement(xe,{stickerMouseDown:t.stickerDragStart})),o.createElement("div",{"data-mode":u.default.TABS.TEXT},o.createElement(Fe,null)),o.createElement("div",{"data-mode":u.default.TABS.PAINT},o.createElement(ke,null))),o.createElement("div",{className:"PhotoEditor__actions"},o.createElement(Ke,{appearance:"secondary",onClick:t.props.data.close},Object(me.getLang)("photos_pe_cancel_action")),o.createElement(Ge,{appearance:"primary",loading:t.props.ui.isSaveLoading,disabled:t.isSaveDisabled,onClick:t.save},e)))},t.renderFontsPreloading=function(){return o.createElement("div",{className:"PhotoEditor__fontPreload"},u.default.FONTS.map(function(e){return o.createElement("span",{key:e,style:{fontFamily:e}})}))},t.save=function(){t.props.setCurrentLayer(null),t.props.setSaveLoading(!0),t.renderFinalImage().then(function(e){var r=t.props,n=r.layers,o=r.drawings,a=r.background,i=Object(L.prepareStat)(n.items,o,a.currentBackgroundType,a.currentBackgroundId);t.props.data.save(e,function(){t.props.setSaveLoading(!1)},{postRawId:t.props.data.addons.postRawId,hash:t.props.data.hash,analytics:JSON.stringify(i)})}).catch(function(e){console.error(e)})},t.renderFinalImage=function(){return new Promise(function(e){var r=document.createElement("canvas"),n=r.getContext("2d"),o=document.querySelector(".EditorCanvas__canvas--bg"),a=document.querySelector(".EditorCanvas__canvas--draw"),i=document.getElementById("EditorCanvas__layers");if(n&&o&&a&&i){r.width=o.width,r.height=o.height,n.drawImage(o,0,0),n.drawImage(a,0,0);var s=t.props.data,c=s.artboardWidth,u=s.artboardHeight,l=s.addons,d=u;l&&l.photoHeight&&(d=l.photoHeight),R.a.toCanvas(i,{width:c,height:d,filter:function(e){return e.nodeType===Node.TEXT_NODE||!e.classList.contains("EditorLayer--sticker")}}).then(function(o){n.drawImage(o,0,0,r.width,r.height),t.renderCanvasLayers(n).then(function(){r.toBlob(function(t){e(t)},"image/jpeg",1)}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}})},t.renderCanvasLayers=function(e){return new Promise(function(r,n){var o=t.props.data.originalWidth/t.props.data.artboardWidth,a=[];t.props.layers.items.forEach(function(r){r.type===u.default.LAYER_TYPES.STICKER&&a.push(t.renderCanvasSticker(e,r,o))}),Promise.all(a).then(r).catch(function(e){n(e)})})},t.renderCanvasSticker=function(e,r,n){var o=t.getStickerUrlById(r.id,u.default.STICKER_LARGE);return Object(G.loadImage)(o).then(function(t){var o=r.width*n,a=r.height*n,i=(r.x-r.width/2)*n,s=(r.y-r.height/2)*n;e.save(),e.translate(i,s),e.translate(o/2,a/2),e.rotate(r.rotate*Math.PI/180),e.translate(-o/2,-a/2),e.drawImage(t,0,0,o,a),e.restore()})},t.handleKeyDown=function(e){if((e.ctrlKey||e.metaKey)&&90===e.keyCode&&t.props.ui.currentMode===u.default.TABS.PAINT&&t.props.undoDrawing(),null!==t.props.layers.currentIndex&&"TEXTAREA"!==e.target.nodeName)if(e.keyCode===He.KEY.DEL)e.preventDefault(),t.props.deleteLayer();else if([He.KEY.UP,He.KEY.DOWN,He.KEY.LEFT,He.KEY.RIGHT].includes(e.keyCode)){var r=t.getCurrentLayer();if(!r)return;var n={x:r.x,y:r.y},o=e.shiftKey?10:1;switch(e.keyCode){case He.KEY.UP:n.y-=o;break;case He.KEY.DOWN:n.y+=o;break;case He.KEY.LEFT:n.x-=o;break;case He.KEY.RIGHT:n.x+=o}t.props.updateLayer({x:n.x,y:n.y})}},t.canvasMouseDown=function(e){var r=t.getCurrentLayer(),n=e.target;if(r&&r.isFixed)t.layerDragFinish(e);else if("TEXTAREA"!==n.tagName)return!!n.closest(".EditorCanvas")&&(!n.closest(".SwitchMode")&&void(t.props.ui.currentMode!==u.default.TABS.PAINT&&(r&&r.type===u.default.LAYER_TYPES.TEXT&&r.isEdit?t.props.closeTextEditor():n.closest(".EditorLayer")?t.layerDragStart(e):r&&t.props.setCurrentLayer(null))))},t.getCurrentLayer=function(){var e=t.props.layers,r=e.items,n=e.currentIndex;return null===n?n:r[n]},t.layerDragStart=function(e,r){window.addEventListener("mousemove",t.layerDragProcess),window.addEventListener("mouseup",t.layerDragFinish);var n,o=e.target.closest("[data-index]");n=o?+Object(Ye.domData)(o,"index"):t.props.layers.currentIndex,t.props.layers.currentIndex!==n&&t.props.setCurrentLayer(n);var a=Object(G.getRelativeXY)(e,document.querySelector(".EditorCanvas__canvas--draw")),i=a.x,s=a.y,c=a.xOrigin,u=a.yOrigin;t.currentLayer=t.getCurrentLayer(),t.currentLayer&&(t.fromPanel=r,t.clientX=e.clientX,t.clientY=e.clientY,t.fromPanel?(t.shiftX=0,t.shiftY=0,t.shiftBodyX=0,t.shiftBodyY=0):(t.shiftX=i-t.currentLayer.x,t.shiftY=s-t.currentLayer.y,t.shiftBodyX=t.clientX-(t.currentLayer.x+c),t.shiftBodyY=t.clientY-(t.currentLayer.y+u)))},t.layerDragProcess=function(e){void 0!==t.shiftBodyX&&void 0!==t.shiftBodyY&&(t.props.updateLayer({x:Math.round(e.clientX-t.shiftBodyX),y:Math.round(e.clientY-t.shiftBodyY),isFixed:!0,isHide:!1}),t.fromPanel||t.props.ui.isShowDropBox||t.props.setShowDropBox(!0))},t.layerDragFinish=function(e){if(window.removeEventListener("mousemove",t.layerDragProcess),window.removeEventListener("mouseup",t.layerDragFinish),t.getCurrentLayer()&&t.currentLayer&&void 0!==t.shiftX&&void 0!==t.shiftY){var r=document.querySelector(".EditorCanvas__canvas--draw");if(r){var n=Object(G.getRelativeXY)(e,r),o=n.x,a=n.y,i=r.getBoundingClientRect(),s=i.width,c=i.height,u=o-t.shiftX,l=a-t.shiftY,d=!1;if(t.fromPanel){var f=t.currentLayer.width/2,p=t.currentLayer.height/2;t.clientX===e.clientX&&t.clientY===e.clientY?(u=r.offsetWidth/2,l=r.offsetHeight/2):(u+f<0||u-f>s||l+p<0||l-p>c)&&(d=!0)}t.props.updateLayer({x:Math.round(u),y:Math.round(l),isFixed:!1,isHide:!1}),d&&t.props.deleteLayer(),t.props.setShowDropBox(!1),delete t.currentLayer,delete t.shiftX,delete t.shiftY,delete t.shiftBodyX,delete t.shiftBodyY,delete t.fromPanel,delete t.clientX,delete t.clientY}}},t.getStickerUrlById=function(e,r){var n=t.props.data.stickersMap[e];return n?n.sizes[r]:""},t.stickerDragStart=function(e,r){e.persist();var n=t.getCurrentLayer();if(!n||!n.isFixed){var o=document.querySelector(".EditorCanvas__canvas--draw");if(o){var a=u.default.LAYER_DEFAULT_SIZE/2,i=Math.floor(o.width/u.default.CANVAS_SCALE/2-a),s=Math.floor(o.height/u.default.CANVAS_SCALE/2-a);t.props.addLayerSticker({id:r,x:i,y:s,width:u.default.LAYER_DEFAULT_SIZE,height:u.default.LAYER_DEFAULT_SIZE,rotate:0,isHide:!0,isFixed:!1}),setTimeout(function(){t.layerDragStart(e.nativeEvent,!0)},0)}}},t}return We(t,e),t}(o.Component),qe=Object(a.connect)(function(e){return{ui:e.ui,settings:e.settings,layers:e.layers,drawings:e.drawings,background:e.background,data:e.data}},function(e){return{setMode:function(t){return e(H(t))},addLayerSticker:function(t){return e(function(e){return Object(L.sendStat)(L.EVENTS.ADD_STICKER),I("ADD_LAYER_STICKER",{type:u.default.LAYER_TYPES.STICKER,id:e.id,x:e.x,y:e.y,width:e.width,height:e.height,rotate:e.rotate,isHide:e.isHide,isFixed:e.isFixed})}(t))},addLayerText:function(){return e(A())},updateLayer:function(t){return e(M(t))},undoDrawing:function(){return e(W())},deleteLayer:function(){return e(B())},setCurrentLayer:function(t){return e(k(t))},setDataLoaded:function(){return e({type:"SET_DATA_LOADED"})},setShowDropBox:function(t){return e(U(t))},setSaveLoading:function(t){return e(function(e){return{type:"SET_SAVE_LOADING",value:e}}(t))},closeTextEditor:function(){return e(F())},setData:function(t){return e(function(e){return{type:"SET_DATA",payload:e}}(t))}}})(Ve),ze=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$e=function(){return($e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getBackgroundType=function(){var e=u.default.CONTEXT_TYPES,r=u.default.BACKGROUND_MODES;return t.props.context===e.STORY?t.props.photoUrl?r.PHOTO:r.BACKGROUND:r.PHOTO},t}return ze(t,e),t.prototype.render=function(){var e=x(),t=$e($e({},e.getState()),{data:this.props,background:{currentBackgroundType:this.getBackgroundType(),currentPhotoUrl:this.props.photoUrl,currentBackgroundId:1}}),r=x(t);return o.createElement(a.Provider,{store:r},o.createElement(qe,null))},t.defaultProps={originalWidth:u.default.STORY_BASE_WIDTH,originalHeight:u.default.STORY_BASE_HEIGHT},t}(o.Component);r.d(t,"default",function(){return Ze})},mYgU:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r("yOtm")),a=n(r("Ya8i")),i=n(r("WfVW")),s=n(r("xkiS")),c=n(r("t0N9")),u=r("Iwry");function l(e,t){return void 0===t&&(t={}),{width:t.width||u.getNodeWidth(e),height:t.height||u.getNodeHeight(e)}}function d(e,t){void 0===t&&(t={});var r=l(e,t),n=r.width,u=r.height;return o.default(e,t.filter,!0).then(function(e){return a.default(e,t)}).then(function(e){return i.default(e,t)}).then(function(e){return c.default(e,t)}).then(function(e){return s.default(e,n,u)})}function f(e,t){return void 0===t&&(t={}),d(e,t).then(u.createImage).then(u.delay(100)).then(function(r){var n=document.createElement("canvas"),o=n.getContext("2d"),a=u.getPixelRatio(),i=l(e,t),s=i.width,c=i.height;return n.width=s*a,n.height=c*a,n.style.width=""+s,n.style.height=""+c,o.scale(a,a),t.backgroundColor&&(o.fillStyle=t.backgroundColor,o.fillRect(0,0,n.width,n.height)),o.drawImage(r,0,0),n})}function p(e,t){void 0===t&&(t={});var r=l(e,t),n=r.width,o=r.height;return f(e,t).then(function(e){return e.getContext("2d").getImageData(0,0,n,o).data})}function h(e,t){return void 0===t&&(t={}),f(e,t).then(function(e){return e.toDataURL()})}function m(e,t){return void 0===t&&(t={}),f(e,t).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})}function y(e,t){return void 0===t&&(t={}),f(e,t).then(u.canvasToBlob)}t.toSvgDataURL=d,t.toCanvas=f,t.toPixelData=p,t.toPng=h,t.toJpeg=m,t.toBlob=y,t.default={toSvgDataURL:d,toCanvas:f,toPixelData:p,toPng:h,toJpeg:m,toBlob:y}},nAFc:function(e,t,r){"use strict";r.r(t),r.d(t,"encodeHTMLEntities",function(){return s}),r.d(t,"escape",function(){return c}),r.d(t,"decodeHTMLEntities",function(){return u}),r.d(t,"prepareToWriting",function(){return l});r("a1Th"),r("Btvt"),r("rE2o"),r("ioFf"),r("rGqo"),r("Oyvg"),r("pIFo");var n=r("yqpO"),o=r("vkmG");function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=o.symbols,s=o.encodeHTMLEntities,c=o.escape;function u(e){return i.reduce((e,t)=>{var r=a(t,2),n=r[0],o=r[1];return e.replace(new RegExp(n,"ig"),o)},e).replace(/&#(\d+);/g,(e,t)=>String.fromCodePoint(t))}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.lineBreak,o=void 0!==r&&r,a=t.convertEmoji,i=void 0===a||a,s=u(e);return s=s.replace(/\n\r/gi,"\n"),"oneline"===o?s=s.replace(/<br>/gi," ").replace(/\n/gi," "):"html"===o&&(s=s.replace(/\n/gi,"<br>")),s=c(s),i&&(s=Object(n.emojiToHTML)(s,!0)),s}},qT12:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,d=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,h=n?Symbol.for("react.suspense"):60113,m=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116;function v(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case d:case f:case i:case c:case s:case h:return e;default:switch(e=e&&e.$$typeof){case l:case p:case u:return e;default:return t}}case y:case m:case a:return t}}}function g(e){return v(e)===f}t.typeOf=v,t.AsyncMode=d,t.ConcurrentMode=f,t.ContextConsumer=l,t.ContextProvider=u,t.Element=o,t.ForwardRef=p,t.Fragment=i,t.Lazy=y,t.Memo=m,t.Portal=a,t.Profiler=c,t.StrictMode=s,t.Suspense=h,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===f||e===c||e===s||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===m||e.$$typeof===u||e.$$typeof===l||e.$$typeof===p)},t.isAsyncMode=function(e){return g(e)||v(e)===d},t.isConcurrentMode=g,t.isContextConsumer=function(e){return v(e)===l},t.isContextProvider=function(e){return v(e)===u},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return v(e)===p},t.isFragment=function(e){return v(e)===i},t.isLazy=function(e){return v(e)===y},t.isMemo=function(e){return v(e)===m},t.isPortal=function(e){return v(e)===a},t.isProfiler=function(e){return v(e)===c},t.isStrictMode=function(e){return v(e)===s},t.isSuspense=function(e){return v(e)===h}},r7nW:function(e,t,r){"use strict";r.r(t);var n=r("q1tI"),o=r("i8i4"),a=(r("17x9"),r("pemR"));class i extends n.Component{constructor(){super(...arguments),this.getScrollbarWidth=()=>{var e=document.createElement("div");e.classList.add("BaseModal__scrollbarMeasure"),document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t},this.hideScrollBar=()=>{var e=document.body.getBoundingClientRect(),t=e.left+e.right<window.innerWidth,r=this.getScrollbarWidth();this.calculatedPadding=window.getComputedStyle(document.body)["padding-right"],t&&(document.body.style.paddingRight=`${parseFloat(this.calculatedPadding)+r}px`),document.body.classList.add("BaseModal__bodyHiddenOverflow")},this.showScrollBar=()=>{document.body.style.paddingRight=this.calculatedPadding,document.body.classList.remove("BaseModal__bodyHiddenOverflow")},this.onDocumentKeyDown=e=>{var t=this.props.onClose;"Escape"===e.key&&t()},this.onBackdropClick=()=>{var e=this.props,t=e.onClose;!e.disableBackdropClick&&t()}}componentDidMount(){var e=this.props,t=e.disableEscapeClose,r=e.disableBodyScroll;t||document.body.addEventListener("keydown",this.onDocumentKeyDown),r&&this.hideScrollBar()}componentWillUnmount(){var e=this.props,t=e.disableEscapeClose,r=e.disableBodyScroll;t||document.body.removeEventListener("keydown",this.onDocumentKeyDown),r&&this.showScrollBar()}renderModal(){var e=this.props.className,t=Object(a.classNames)("BaseModal",e);return n.createElement("div",{className:t,"aria-modal":"true"},n.createElement("div",{className:"BaseModal__backdrop",onClick:this.onBackdropClick}),n.createElement("div",{className:"BaseModal__content"},this.props.children))}render(){return o.createPortal(this.renderModal(),document.body)}}i.defaultProps={className:"",children:null,disableBackdropClick:!1,disableEscapeClose:!1,disableBodyScroll:!1},t.default=i},sINF:function(e,t,r){"use strict";function n(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(o){return"function"==typeof o?o(r,n,e):t(o)}}}}r.r(t);var o=n();o.withExtraArgument=n,t.default=o},t0N9:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e.style;return t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=t.width+"px"),t.height&&(r.height=t.height+"px"),t.style&&Object.assign(r,t.style),e}},ufMw:function(e,t,r){"use strict";r.r(t),r.d(t,"EVENTS",function(){return s}),r.d(t,"sendStat",function(){return c}),r.d(t,"prepareStat",function(){return u});var n=r("1y80"),o=r("98sY"),a=r("xYVc"),i=r("W9Tc"),s={ADD_STORY:"add_story",ADD_STORY_FROM_SHARING:"add_story_from_sharing",ADD_PHOTO_IN_POPUP:"add_photo_in_popup",CREATE_STORY_WITHOUT_PHOTO:"create_story_without_photo",CLICK_TO_CAMERA_ICON:"click_to_camera_icon",CLICK_TO_GRADIENT_ICON:"click_to_gradient_icon",ADD_TEXT:"add_text",EDIT_TEXT:"edit_text",DELETE_TEXT:"delete_text",ADD_STICKER:"add_sticker",DELETE_STICKER:"delete_sticker",ADD_GRAFFITI:"add_graffiti",CANCEL_GRAFFITI:"cancel_graffiti",SELECT_BACKGROUND:"select_background"};function c(e){if(window.cur.storyPublishContext){var t={event_type:e,story_type:"photo"};Object(i.partConfigEnabled)("story_publish_analytics_log")&&Object(o.debugLog)(t),Object(n.statlogsValueEvent)("story_create_product_analytics",t)}}function u(e,t,r,n){var o={RobotoPE:"classic",PacificoPE:"italics",AmaticPE:"typewriter",TTCommonsPE:"cursive",GoraPE:"marker",DinPE:"poster"},i=0,s="photo";r===a.default.BACKGROUND_MODES.BACKGROUND&&(s=(i=n)>100?"emojies":"gradients");var c={has_text:0,has_sticker:0,has_graffiti:0,background_type:s,background_id:i},u=[],l=[],d=[];return e.forEach(function(e){if(e.type===a.default.LAYER_TYPES.STICKER){var t=(s=e).id.split("_"),r=t[0],n=t[1],i=parseInt(r);u.push({id:parseInt(n),pack_id:i||0,type:i?"from_pack":"individual"})}else if(e.type===a.default.LAYER_TYPES.TEXT){var s=e;l.push({text:s.text,font:o[s.fontFamily],size:Math.round(s.fontSize*a.default.FONT_SIZE_COEFFICIENT),color:s.color.slice(1),background:"none",align:"center"})}}),l.length&&(c.has_text=1,c.texts=l),u.length&&(c.has_sticker=1,c.stickers=u),t.forEach(function(e){d.push({brush:e.opacity,size:e.width,color:e.color.slice(1)})}),d.length&&(c.has_graffiti=1,c.graffities=d),c}},vRp6:function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return c});r("a1Th"),r("Btvt"),r("rE2o"),r("ioFf"),r("rGqo");var n=r("q1tI"),o=(r("17x9"),r("UlUB")),a=r("PjZB"),i=r("pemR");function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}class c extends n.Component{constructor(e){super(e),this.checkLoad=Object(o.default)(e=>{var t=s(e,3),r=t[0],n=t[1],o=t[2];if(!this.loading)return this.props.virtualized||this.props.hasMore?void(n-r-o<=this.props.threshold&&(this.loading=!0,this.props.loadMore().then(()=>{this.loading=!1}))):this.detachListeners()},34),this.onScroll=e=>{var t=this.getScrollData();this.props.virtualized&&this.processChildren(this.props.children,t),this.props.hasMore&&this.checkLoad(t)},this.getRef=e=>{this.container=e,this.props.virtualized&&this.setState(this.getChildrenData(this.props.children,this.getScrollData()))},this.useWindowScroll=e.useWindowScroll,e.virtualized&&(this.state={before:0,after:e.children.length,start:0,end:0})}getScrollData(){var e=this.useWindowScroll?document.documentElement:this.container;return[this.getScrollTop(),e?e.scrollHeight:0,e?e.clientHeight:0]}getScrollTop(){var e=document.documentElement||document.body.parentNode||document.body;return this.useWindowScroll?void 0!==window.pageYOffset?window.pageYOffset:e.scrollTop:this.container?this.container.scrollTop:0}attachListeners(){var e=this.useWindowScroll?window:this.container;this.container&&(e.addEventListener("scroll",this.onScroll,this.props.useCapture),e.addEventListener("resize",this.onScroll,this.props.useCapture))}detachListeners(){var e=this.useWindowScroll?window:this.container;this.container&&(e.removeEventListener("scroll",this.onScroll,this.props.useCapture),e.removeEventListener("resize",this.onScroll,this.props.useCapture))}processChildren(e,t){var r=this.state,n=this.getChildrenData(e,t||this.getScrollData()),o=n.start,a=n.end,i=n.before,s=n.after;o===r.start&&a===r.end&&i===r.before&&s===r.after||this.setState(n)}getChildrenData(e,t){var r=s(t,3),n=r[0],o=r[1],a=r[2],i=this.useWindowScroll?window:this.container,c=i&&i.offsetHeight;if(!i||0===o||0===a)return{start:0,end:0,before:0,after:e.length};a=Math.max(a,c);var u=e.length,l=Math.max(Math.floor(n/this.props.itemHeight)-1,0),d=Math.min(Math.floor((n+2*a)/this.props.itemHeight+1),u);return{start:l,end:d,before:l,after:u-d}}componentWillReceiveProps(e){this.props.virtualized&&this.processChildren(e.children)}componentDidMount(){this.attachListeners()}componentWillUnmount(){this.detachListeners()}render(){return n.createElement("div",{className:Object(i.classNames)("InfiniteScroll",this.props.className),ref:this.getRef,style:this.props.style},this.props.virtualized&&this.state.before>0&&n.createElement("div",{style:{height:this.state.before*this.props.itemHeight},key:"before"}),this.props.virtualized?[].concat(this.props.children).slice(this.state.start,this.state.end):this.props.children,this.props.virtualized&&this.state.after>0&&n.createElement("div",{style:{height:this.state.after*this.props.itemHeight},key:"after"}),this.props.hasMore&&(this.props.loader||n.createElement("div",{className:"InfiniteScroll__loader",key:"loader"},n.createElement(a.default,null))))}}c.defaultProps={useWindowScroll:!1,virtualized:!1,hasMore:!0,useCapture:!1,threshold:100,itemHeight:55}},vTYg:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("Iwry");function o(e,t,r){var o="."+e+":"+t,a=r.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(r):function(e){return n.toArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")+";"}).join(" ")}(r);return document.createTextNode(o+"{"+a+"}")}t.default=function(e,t){[":before",":after"].forEach(function(r){return function(e,t,r){var a=window.getComputedStyle(e,r),i=a.getPropertyValue("content");if(""!==i&&"none"!==i){var s=n.uuid(),c=document.createElement("style");c.appendChild(o(s,r,a)),t.className=t.className+" "+s,t.appendChild(c)}}(e,t,r)})}},wx14:function(e,t,r){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r.r(t),r.d(t,"default",function(){return n})},xYVc:function(e,t,r){"use strict";r.r(t);var n=r("t7n3");t.default={TABS:{STICKERS:"stickers",TEXT:"text",PAINT:"paint",CROP:"crop",FILTERS:"filters",COLOR:"color"},BACKGROUND_MODES:{PHOTO:"photo",BACKGROUND:"background"},STORY_BASE_WIDTH:1080,STORY_BASE_HEIGHT:1920,BOTTOM_PANEL_HEIGHT:50,CANVAS_SCALE:Object(n.isRetina)()?2:1,STICKER_SMALL:64,STICKER_MEDIUM:Object(n.isRetina)()?256:128,STICKER_LARGE:512,COLORS:["#FFFFFF","#000000","#E64646","#FF9300","#FFCB00","#62DA37","#00AEF9","#CC74E1"],FONTS:["RobotoPE","PacificoPE","AmaticPE","TTCommonsPE","GoraPE","DinPE"],BRUSH_WIDTH_COEFFICIENT:40,FONT_SIZE_COEFFICIENT:100,LAYER_TYPES:{STICKER:"sticker",TEXT:"text"},LAYER_MIN_SIZE:30,LAYER_DEFAULT_SIZE:128,CONTEXT_TYPES:{PHOTO:"photo",STORY:"story"}}},xkiS:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("Iwry");t.default=function(e,t,r){var o="http://www.w3.org/2000/svg",a=document.createElementNS(o,"svg"),i=document.createElementNS(o,"foreignObject");return a.setAttributeNS("","width",""+t),a.setAttributeNS("","height",""+r),i.setAttributeNS("","width","100%"),i.setAttributeNS("","height","100%"),i.setAttributeNS("","x","0"),i.setAttributeNS("","y","0"),i.setAttributeNS("","externalResourcesRequired","true"),a.appendChild(i),i.appendChild(e),n.svgToDataURL(a)}},yOtm:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r("Iwry"),a=n(r("vTYg"));function i(e){return e instanceof HTMLCanvasElement?o.createImage(e.toDataURL()):e.tagName&&"svg"===e.tagName.toLowerCase()?Promise.resolve(e).then(function(e){return o.svgToDataURL(e)}).then(o.createImage):Promise.resolve(e.cloneNode(!1))}function s(e,t){return t instanceof Element?Promise.resolve().then(function(){return function(e,t){var r=window.getComputedStyle(e),n=t.style;r.cssText?n.cssText=r.cssText:o.toArray(r).forEach(function(e){n.setProperty(e,r.getPropertyValue(e),r.getPropertyPriority(e))})}(e,t)}).then(function(){return a.default(e,t)}).then(function(){return function(e,t){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}(e,t)}).then(function(){return t}):t}function c(e,t,r){return r||!t||t(e)?Promise.resolve(e).then(i).then(function(r){return function(e,t,r){var n=o.toArray(e.childNodes);return 0===n.length?Promise.resolve(t):n.reduce(function(e,n){return e.then(function(){return c(n,r)}).then(function(e){e&&t.appendChild(e)})},Promise.resolve()).then(function(){return t})}(e,r,t)}).then(function(t){return s(e,t)}):Promise.resolve(null)}t.default=c},zLVn:function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}r.r(t),r.d(t,"default",function(){return n})}});